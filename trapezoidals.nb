(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     53179,       1193]
NotebookOptionsPosition[     49283,       1137]
NotebookOutlinePosition[     49684,       1153]
CellTagsIndexPosition[     49641,       1150]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TrapezoidalIntegration", "[", 
    RowBox[{"data_List", ",", "dx_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "sum"}], "}"}], ",", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sum", "=", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "+", 
        RowBox[{"2", "*", 
         RowBox[{"Total", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"dx", "/", "2"}], ")"}], "*", "sum"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellLabel->
  "In[380]:=",ExpressionUUID->"841095ea-e8ff-4a44-a593-ef8388517744"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"m1", "=", 
  RowBox[{"TrapezoidalIntegration", "[", 
   RowBox[{"table1", ",", "delta"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"m1IC2", "=", 
  RowBox[{"TrapezoidalIntegration", "[", 
   RowBox[{"tableIC2", ",", "delta"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m1SC2", "=", 
   RowBox[{"TrapezoidalIntegration", "[", 
    RowBox[{"tableSC2", ",", "delta"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"var1", "=", 
  RowBox[{
   RowBox[{"2", "*", 
    RowBox[{"TrapezoidalIntegration", "[", 
     RowBox[{
      RowBox[{"table1", "*", "\[Tau]"}], ",", "delta"}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"TrapezoidalIntegration", "[", 
     RowBox[{"table1", ",", "delta"}], "]"}], "^", 
    "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"var1IC2", "=", 
  RowBox[{
   RowBox[{"2", "*", 
    RowBox[{"TrapezoidalIntegration", "[", 
     RowBox[{
      RowBox[{"tableIC2", "*", "\[Tau]"}], ",", "delta"}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"TrapezoidalIntegration", "[", 
     RowBox[{"tableIC2", ",", "delta"}], "]"}], "^", 
    "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"var1SC2", "=", 
  RowBox[{
   RowBox[{"2", "*", 
    RowBox[{"TrapezoidalIntegration", "[", 
     RowBox[{
      RowBox[{"tableSC2", "*", "\[Tau]"}], ",", "delta"}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"TrapezoidalIntegration", "[", 
     RowBox[{"tableSC2", ",", "delta"}], "]"}], "^", 
    "2"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.943523483462543*^9, 3.9435235244681883`*^9}, 
   3.94352356805119*^9, 3.943523781653843*^9, {3.943525616405194*^9, 
   3.943525624915559*^9}, {3.943527612117895*^9, 3.943527636339199*^9}, {
   3.943527718223034*^9, 3.94352771997558*^9}, {3.94352823734722*^9, 
   3.9435282564994416`*^9}, {3.943529199885479*^9, 3.94352920016166*^9}, {
   3.943529398729306*^9, 3.94352939884242*^9}, 3.943529553975356*^9, {
   3.94353409337735*^9, 3.943534095687509*^9}, {3.943537369998979*^9, 
   3.94353737233613*^9}, {3.943537421624007*^9, 3.94353742300181*^9}, {
   3.943537463207874*^9, 3.943537463263458*^9}, 3.943538258877202*^9, {
   3.943538638494431*^9, 3.943538641879647*^9}, {3.943539578891369*^9, 
   3.943539580725632*^9}, {3.943539614564824*^9, 3.943539616318795*^9}, 
   3.943541884655417*^9, {3.943700286261816*^9, 3.943700295495974*^9}, {
   3.9437083126798143`*^9, 3.943708356950088*^9}, {3.943708417700944*^9, 
   3.943708519607537*^9}, {3.943708567503545*^9, 3.943708571040987*^9}, 
   3.94370873106936*^9, {3.945419867581755*^9, 3.945419874045115*^9}, {
   3.94542272827136*^9, 3.945422732813153*^9}},
 CellLabel->
  "In[1818]:=",ExpressionUUID->"b1ee6303-df19-4b84-bcc3-8c8a9f781d4b"],

Cell[BoxData["0.9464875828258705`"], "Output",
 CellChangeTimes->{3.946127684442738*^9, 3.946131257746312*^9, 
  3.946131299867737*^9, 3.946133265228694*^9},
 CellLabel->
  "Out[1818]=",ExpressionUUID->"6713235d-af39-43fb-8be8-540a2d39dd61"],

Cell[BoxData["1.3994895581799023`"], "Output",
 CellChangeTimes->{3.946127684442738*^9, 3.946131257746312*^9, 
  3.946131299867737*^9, 3.946133265229456*^9},
 CellLabel->
  "Out[1819]=",ExpressionUUID->"f616e435-abb4-433a-a363-105cf4b5691f"],

Cell[BoxData["3.2064261350714705`"], "Output",
 CellChangeTimes->{3.946127684442738*^9, 3.946131257746312*^9, 
  3.946131299867737*^9, 3.9461332652300997`*^9},
 CellLabel->
  "Out[1820]=",ExpressionUUID->"a3a0555e-e555-4827-8ebc-bcfc91f60f8d"],

Cell[BoxData["1.6050294683170212`"], "Output",
 CellChangeTimes->{3.946127684442738*^9, 3.946131257746312*^9, 
  3.946131299867737*^9, 3.9461332652307663`*^9},
 CellLabel->
  "Out[1821]=",ExpressionUUID->"eefdb019-4209-4f49-90f1-afc9433db053"],

Cell[BoxData["2.653472595891687`"], "Output",
 CellChangeTimes->{3.946127684442738*^9, 3.946131257746312*^9, 
  3.946131299867737*^9, 3.946133265231394*^9},
 CellLabel->
  "Out[1822]=",ExpressionUUID->"13d1c6f7-b9b3-4abc-a5c4-719cc3cd4799"],

Cell[BoxData["72.6349870473091`"], "Output",
 CellChangeTimes->{3.946127684442738*^9, 3.946131257746312*^9, 
  3.946131299867737*^9, 3.946133265231923*^9},
 CellLabel->
  "Out[1823]=",ExpressionUUID->"f9e9be5e-099e-4e61-8b46-42beece3794a"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.94587895029923*^9, 3.945878972011565*^9}, 
   3.945879212526174*^9, 
   3.9459482810907097`*^9},ExpressionUUID->"aa059d93-b9c3-4e37-9d61-\
b01cedb0ba8a"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"For", " ", "kappa"}], "=", 
     RowBox[{"2", "/", "b"}]}], ",", " ", 
    RowBox[{"epsilon", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", "7"}], " ", "dB", " ", "this", " ", "is", " ", "a", " ", 
      "good", " ", "good", " ", 
      RowBox[{"setting", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"delta", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"min", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Tau]", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"t", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "min", ",", "500", ",", "delta"}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p\[Tau]s", "=", 
     RowBox[{"\[Tau]", "/", 
      RowBox[{"(", 
       RowBox[{"1.", "+", "\[Tau]"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"table1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{"min", "-", "delta"}], ",", "delta"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"table1", "=", 
     RowBox[{"{", 
      RowBox[{"table1", ",", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{"kprobintegrand", "[", 
              RowBox[{
               RowBox[{"{", "z1", "}"}], ",", "i"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"z1", ",", "p\[Tau]", ",", "1"}], "}"}], ",", 
             RowBox[{"Method", "->", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", 
                RowBox[{"\"\<SymbolicProcessing\>\"", "->", "0"}]}], "}"}]}], 
             ",", 
             RowBox[{"MinRecursion", "->", "1"}], ",", 
             RowBox[{"AccuracyGoal", "->", "1"}], ",", 
             RowBox[{"PrecisionGoal", "->", "1"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{"Ceiling", "[", 
              RowBox[{
               RowBox[{"1", "/", "p\[Tau]"}], "-", "1", "-", "1"}], "]"}]}], 
            "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"p\[Tau]", ",", "p\[Tau]s"}], "}"}]}], "]"}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"table1", "=", 
     RowBox[{"Flatten", "[", "table1", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tableIC2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{"min", "-", "delta"}], ",", "delta"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AbsoluteTiming", "[", 
     RowBox[{"tableIC2", "=", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"tableIC2", ",", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"kprobintegrand", "[", 
                RowBox[{
                 RowBox[{"{", "z1", "}"}], ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"z1", ",", "p\[Tau]", ",", "1"}], "}"}], ",", 
               RowBox[{"Method", "->", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", 
                  RowBox[{"\"\<SymbolicProcessing\>\"", "->", "0"}]}], 
                 "}"}]}], ",", 
               RowBox[{"MinRecursion", "->", "1"}], ",", 
               RowBox[{"AccuracyGoal", "->", "1"}], ",", 
               RowBox[{"PrecisionGoal", "->", "1"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"Ceiling", "[", 
                RowBox[{
                 RowBox[{"1", "/", "p\[Tau]"}], "-", "1", "-", "1"}], "]"}]}],
               "}"}]}], "]"}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"ICintegrand", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"z1", ",", "z2"}], "}"}], ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"z1", ",", "p\[Epsilon]", ",", "p\[Tau]"}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"z2", ",", "p\[Epsilon]", ",", "p\[Tau]"}], "}"}], 
               ",", 
               RowBox[{"Method", "->", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", 
                  RowBox[{"\"\<SymbolicProcessing\>\"", "->", "0"}]}], 
                 "}"}]}], ",", 
               RowBox[{"MinRecursion", "->", "2"}], ",", 
               RowBox[{"AccuracyGoal", "->", "1"}], ",", 
               RowBox[{"PrecisionGoal", "->", "1"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"Ceiling", "[", 
                RowBox[{
                 RowBox[{"1", "/", "p\[Epsilon]"}], "-", "2", "-", "1"}], 
                "]"}]}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"p\[Tau]", ",", "p\[Tau]s"}], "}"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tableIC2", "=", 
     RowBox[{"Flatten", "[", "tableIC2", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tableSC2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{"min", "-", "delta"}], ",", "delta"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AbsoluteTiming", "[", 
     RowBox[{"tableSC2", "=", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"tableSC2", ",", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"kprobintegrand", "[", 
                RowBox[{
                 RowBox[{"{", "z1", "}"}], ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"z1", ",", "p\[Tau]", ",", "1"}], "}"}], ",", 
               RowBox[{"Method", "->", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", 
                  RowBox[{"\"\<SymbolicProcessing\>\"", "->", "0"}]}], 
                 "}"}]}], ",", 
               RowBox[{"MinRecursion", "->", "1"}], ",", 
               RowBox[{"AccuracyGoal", "->", "1"}], ",", 
               RowBox[{"PrecisionGoal", "->", "1"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"Ceiling", "[", 
                RowBox[{
                 RowBox[{"1", "/", "p\[Tau]"}], "-", "1", "-", "1"}], "]"}]}],
               "}"}]}], "]"}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"SICintegrand", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"z1", ",", "z2", ",", "z3"}], "}"}], ",", "i"}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"z1", ",", "0", ",", "p\[Tau]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"z2", ",", "0", ",", "p\[Tau]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"z3", ",", "0", ",", "p\[Tau]"}], "}"}], ",", 
               RowBox[{"Method", "->", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", 
                  RowBox[{"\"\<SymbolicProcessing\>\"", "->", "0"}]}], 
                 "}"}]}], ",", 
               RowBox[{"MinRecursion", "->", "2"}], ",", 
               RowBox[{"AccuracyGoal", "->", "1"}], ",", 
               RowBox[{"PrecisionGoal", "->", "1"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"Ceiling", "[", 
                RowBox[{
                 RowBox[{"1", "/", "p\[Epsilon]"}], "-", "1"}], "]"}]}], 
              "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"p\[Tau]", ",", "p\[Tau]s"}], "}"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tableSC2", "=", 
     RowBox[{"Flatten", "[", "tableSC2", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Tau]", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"t", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"min", "-", "delta"}], ",", "delta"}], "}"}]}], "]"}], ",",
        "\[Tau]"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Tau]", "=", 
     RowBox[{"Flatten", "[", "\[Tau]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.943521152970832*^9, 3.943521175587902*^9}, {
   3.943521210911428*^9, 3.943521216124521*^9}, {3.943521263921122*^9, 
   3.943521317898288*^9}, {3.943521450068367*^9, 3.943521471373767*^9}, {
   3.943522191462724*^9, 3.94352222100518*^9}, {3.943522280425725*^9, 
   3.9435223253107243`*^9}, {3.943522357689878*^9, 3.943522361900292*^9}, {
   3.943522486542739*^9, 3.9435225135087748`*^9}, {3.943522583524704*^9, 
   3.943522641359263*^9}, {3.94352268564543*^9, 3.943522737573858*^9}, {
   3.943523270693336*^9, 3.94352329108509*^9}, {3.943523505687529*^9, 
   3.943523535813001*^9}, {3.943523619387968*^9, 3.943523639373708*^9}, 
   3.943523689414163*^9, {3.943523721395278*^9, 3.943523822736039*^9}, {
   3.943523954233135*^9, 3.943523975572586*^9}, {3.94352414198041*^9, 
   3.943524144118349*^9}, {3.943524179092342*^9, 3.943524219006843*^9}, 
   3.94352564167983*^9, 3.943525967458187*^9, 3.943526431724084*^9, 
   3.943526586385723*^9, {3.943527000749031*^9, 3.9435270008148813`*^9}, {
   3.943527260850241*^9, 3.943527261166953*^9}, {3.943527659807863*^9, 
   3.943527659974612*^9}, {3.943527704236084*^9, 3.943527715026548*^9}, {
   3.943527948059413*^9, 3.943527979580308*^9}, {3.9435281838638783`*^9, 
   3.9435281843650293`*^9}, 3.943528215331899*^9, 3.943528249114327*^9, 
   3.943528364057363*^9, 3.943529142726109*^9, {3.943529190600068*^9, 
   3.943529191265044*^9}, {3.943529386546229*^9, 3.943529392135866*^9}, {
   3.943529524146041*^9, 3.943529544408975*^9}, 3.943529767859383*^9, {
   3.943530985122524*^9, 3.943530985141109*^9}, {3.943531409115771*^9, 
   3.943531410149005*^9}, {3.943531668780034*^9, 3.943531668917923*^9}, 
   3.943532897960033*^9, {3.943534056700036*^9, 3.943534072223324*^9}, {
   3.943536711276416*^9, 3.943536711338254*^9}, {3.943537111529127*^9, 
   3.943537113896467*^9}, {3.943537391312725*^9, 3.943537443613468*^9}, {
   3.943537474326044*^9, 3.943537479880468*^9}, {3.94353758428975*^9, 
   3.943537584466261*^9}, 3.943537851407588*^9, {3.943537908056069*^9, 
   3.943537911040324*^9}, {3.943538274662773*^9, 3.943538279843547*^9}, 
   3.943538417547443*^9, {3.943538627951945*^9, 3.943538629324038*^9}, {
   3.943538719840242*^9, 3.943538720215996*^9}, {3.94353918919563*^9, 
   3.9435391893235083`*^9}, {3.943539425620553*^9, 3.943539455610519*^9}, {
   3.943539534809307*^9, 3.943539611591221*^9}, {3.943539654229601*^9, 
   3.943539686573121*^9}, {3.943539735548325*^9, 3.943539744316552*^9}, {
   3.943539813406772*^9, 3.943539813446265*^9}, {3.943540129721672*^9, 
   3.943540164767027*^9}, {3.943540201252486*^9, 3.943540216859991*^9}, 
   3.943540256049973*^9, {3.9435404246421013`*^9, 3.943540426396223*^9}, {
   3.943540595748618*^9, 3.943540596421273*^9}, 3.943540965766964*^9, {
   3.9435411986289*^9, 3.943541202432184*^9}, {3.943541789951641*^9, 
   3.9435418169851*^9}, 3.94354187243655*^9, {3.943541934204978*^9, 
   3.9435419348280373`*^9}, {3.94354196611441*^9, 3.943541966204404*^9}, {
   3.943542058055639*^9, 3.943542058147928*^9}, {3.943542268020535*^9, 
   3.94354226810563*^9}, {3.94354276114318*^9, 3.943542765136256*^9}, {
   3.943542797594033*^9, 3.943542847311115*^9}, {3.943542911402528*^9, 
   3.943542965931068*^9}, 3.943543342274666*^9, 3.943543377381887*^9, 
   3.943546053181684*^9, {3.9435472047749662`*^9, 3.943547204887936*^9}, {
   3.943547649091826*^9, 3.943547650954145*^9}, 3.9435484263163233`*^9, 
   3.943548866317511*^9, {3.943549880981144*^9, 3.943549881831395*^9}, {
   3.943550263542422*^9, 3.943550269295109*^9}, {3.943551467603479*^9, 
   3.943551467792815*^9}, {3.943551835817751*^9, 3.94355183656152*^9}, {
   3.943552222140199*^9, 3.9435522244523706`*^9}, {3.943593951967042*^9, 
   3.943593959300555*^9}, {3.943594005998407*^9, 3.943594018513704*^9}, 
   3.943595155857366*^9, {3.9436995092926893`*^9, 3.943699580180586*^9}, {
   3.943699979759335*^9, 3.943699996495697*^9}, {3.943700247586052*^9, 
   3.943700271673296*^9}, 3.943700422116541*^9, {3.943700660313315*^9, 
   3.943700716612368*^9}, 3.943700749399891*^9, {3.94370079470821*^9, 
   3.943700801052614*^9}, {3.9437008343966084`*^9, 3.943700891765253*^9}, {
   3.943700954683945*^9, 3.943700994044183*^9}, {3.943701301402256*^9, 
   3.9437014542995453`*^9}, {3.943701614712595*^9, 3.943701622592013*^9}, {
   3.943701707888596*^9, 3.943701714637041*^9}, {3.943702460930027*^9, 
   3.943702466461205*^9}, {3.943702810996295*^9, 3.943702814423442*^9}, {
   3.9437028806857862`*^9, 3.94370288107183*^9}, {3.943703214059669*^9, 
   3.943703229656204*^9}, {3.943703584554405*^9, 3.943703584790307*^9}, 
   3.943703650010686*^9, 3.943703753564286*^9, {3.9437052142282963`*^9, 
   3.9437052153302383`*^9}, 3.94370640715996*^9, {3.943706515244709*^9, 
   3.943706516015483*^9}, {3.943706782477007*^9, 3.943706782753367*^9}, {
   3.94370720464347*^9, 3.943707205120945*^9}, {3.943707808471127*^9, 
   3.943707812535665*^9}, {3.943707962565679*^9, 3.943707986097186*^9}, {
   3.943708016189603*^9, 3.943708065681082*^9}, {3.9437081135119743`*^9, 
   3.943708133115406*^9}, {3.9437081762007017`*^9, 3.9437082077566032`*^9}, {
   3.94370874528949*^9, 3.943708745859083*^9}, {3.943709000337134*^9, 
   3.94370901431116*^9}, {3.943709807822632*^9, 3.94370980790776*^9}, {
   3.943709930171475*^9, 3.943709941514964*^9}, {3.943710147100316*^9, 
   3.943710147167143*^9}, {3.943710177727048*^9, 3.943710199715907*^9}, {
   3.943710259991259*^9, 3.943710271161759*^9}, {3.9437103274234*^9, 
   3.943710382199315*^9}, 3.9437106347996798`*^9, {3.94371082763641*^9, 
   3.9437108276911716`*^9}, 3.943711275858626*^9, {3.94371157538536*^9, 
   3.943711578630378*^9}, {3.94371202863936*^9, 3.94371203082623*^9}, {
   3.943712793549653*^9, 3.9437127948033457`*^9}, {3.943712930380777*^9, 
   3.943712930980564*^9}, {3.943713102856541*^9, 3.9437131033544083`*^9}, {
   3.945421922376333*^9, 3.9454219373388147`*^9}, {3.945421996666791*^9, 
   3.9454220060128*^9}, {3.945422039115288*^9, 3.9454220600267477`*^9}, {
   3.945422092684205*^9, 3.945422261916122*^9}, {3.945422446879353*^9, 
   3.945422514731234*^9}, {3.945422754080884*^9, 3.9454227940956373`*^9}, {
   3.945422829281414*^9, 3.945422833664005*^9}, {3.945427407478984*^9, 
   3.945427407765781*^9}, 3.945427667785448*^9, {3.94584805211423*^9, 
   3.945848087346509*^9}, {3.945848345909595*^9, 3.945848353461317*^9}, {
   3.945849761577309*^9, 3.945849765642134*^9}, {3.945948037010213*^9, 
   3.945948040438755*^9}, {3.945948149975335*^9, 3.945948151931188*^9}, 
   3.94612575556789*^9, {3.946126559970656*^9, 3.9461266089430943`*^9}},
 CellLabel->
  "In[1803]:=",ExpressionUUID->"ba68314b-d776-4989-a414-5168d8d4b5b8"],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{
  3.9461330030647697`*^9},ExpressionUUID->"c8b4f572-025c-4aa7-ad6f-\
cd442cff7752"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"m", "=", 
    RowBox[{"TrapezoidalIntegration", "[", 
     RowBox[{"table", ",", "delta"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"m1", "=", 
    RowBox[{"TrapezoidalIntegration", "[", 
     RowBox[{"table1", ",", "delta"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"m2", "=", 
    RowBox[{"TrapezoidalIntegration", "[", 
     RowBox[{"table2", ",", "delta"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"m3", "=", 
    RowBox[{"TrapezoidalIntegration", "[", 
     RowBox[{"table3", ",", "delta"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"var", "=", 
    RowBox[{
     RowBox[{"2", "*", 
      RowBox[{"TrapezoidalIntegration", "[", 
       RowBox[{
        RowBox[{"table", "*", "\[Tau]"}], ",", "delta"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"TrapezoidalIntegration", "[", 
       RowBox[{"table", ",", "delta"}], "]"}], "^", "2"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"var1", "=", 
    RowBox[{
     RowBox[{"2", "*", 
      RowBox[{"TrapezoidalIntegration", "[", 
       RowBox[{
        RowBox[{"table1", "*", "\[Tau]"}], ",", "delta"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"TrapezoidalIntegration", "[", 
       RowBox[{"table1", ",", "delta"}], "]"}], "^", "2"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"var2", "=", 
    RowBox[{
     RowBox[{"2", "*", 
      RowBox[{"TrapezoidalIntegration", "[", 
       RowBox[{
        RowBox[{"table2", "*", "\[Tau]"}], ",", "delta"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"TrapezoidalIntegration", "[", 
       RowBox[{"table2", ",", "delta"}], "]"}], "^", "2"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"var3", "=", 
    RowBox[{
     RowBox[{"2", "*", 
      RowBox[{"TrapezoidalIntegration", "[", 
       RowBox[{
        RowBox[{"table3", "*", "\[Tau]"}], ",", "delta"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"TrapezoidalIntegration", "[", 
       RowBox[{"table3", ",", "delta"}], "]"}], "^", "2"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.945948286064129*^9, 3.9459482865333347`*^9}, {
   3.946114764437201*^9, 3.94611479206967*^9}, 3.9461175521220226`*^9, {
   3.9461221778842983`*^9, 3.946122215493824*^9}},
 CellLabel->
  "In[1953]:=",ExpressionUUID->"b47da379-013d-43ea-b2f3-5bf2232b4ff4"],

Cell[BoxData["0.8195215330701049`"], "Output",
 CellChangeTimes->{3.946128658740675*^9, 3.94612941551252*^9, 
  3.946129812470614*^9, 3.946130413126638*^9, 3.946130928329789*^9, 
  3.946132843952215*^9, 3.9461329401177063`*^9, 3.946133723555293*^9},
 CellLabel->
  "Out[1953]=",ExpressionUUID->"51ad0216-c330-4339-94b6-8d6b250842ef"],

Cell[BoxData["0.8195215330701049`"], "Output",
 CellChangeTimes->{3.946128658740675*^9, 3.94612941551252*^9, 
  3.946129812470614*^9, 3.946130413126638*^9, 3.946130928329789*^9, 
  3.946132843952215*^9, 3.9461329401177063`*^9, 3.946133723555934*^9},
 CellLabel->
  "Out[1954]=",ExpressionUUID->"16c430d0-e736-4db6-9dbe-a315707cc2de"],

Cell[BoxData["1.3727330297285225`"], "Output",
 CellChangeTimes->{3.946128658740675*^9, 3.94612941551252*^9, 
  3.946129812470614*^9, 3.946130413126638*^9, 3.946130928329789*^9, 
  3.946132843952215*^9, 3.9461329401177063`*^9, 3.946133723556525*^9},
 CellLabel->
  "Out[1955]=",ExpressionUUID->"ef278c5d-1257-4c23-b31c-ba2fb5e149e5"],

Cell[BoxData["1.2489087162981136`"], "Output",
 CellChangeTimes->{3.946128658740675*^9, 3.94612941551252*^9, 
  3.946129812470614*^9, 3.946130413126638*^9, 3.946130928329789*^9, 
  3.946132843952215*^9, 3.9461329401177063`*^9, 3.9461337235572243`*^9},
 CellLabel->
  "Out[1956]=",ExpressionUUID->"06a5c56e-2121-4a19-b827-63f125066fef"],

Cell[BoxData["0.4709921086253839`"], "Output",
 CellChangeTimes->{3.946128658740675*^9, 3.94612941551252*^9, 
  3.946129812470614*^9, 3.946130413126638*^9, 3.946130928329789*^9, 
  3.946132843952215*^9, 3.9461329401177063`*^9, 3.946133723557785*^9},
 CellLabel->
  "Out[1957]=",ExpressionUUID->"16bd6ed5-7f39-41d5-821f-26d05580b5d9"],

Cell[BoxData["0.4709921086253839`"], "Output",
 CellChangeTimes->{3.946128658740675*^9, 3.94612941551252*^9, 
  3.946129812470614*^9, 3.946130413126638*^9, 3.946130928329789*^9, 
  3.946132843952215*^9, 3.9461329401177063`*^9, 3.9461337235586443`*^9},
 CellLabel->
  "Out[1958]=",ExpressionUUID->"2ced4743-9b4c-4a64-8f7c-4cf9a7597f12"],

Cell[BoxData["2.911592426114`"], "Output",
 CellChangeTimes->{3.946128658740675*^9, 3.94612941551252*^9, 
  3.946129812470614*^9, 3.946130413126638*^9, 3.946130928329789*^9, 
  3.946132843952215*^9, 3.9461329401177063`*^9, 3.946133723559194*^9},
 CellLabel->
  "Out[1959]=",ExpressionUUID->"1a5715ca-c33b-42a0-ada5-8666f369e5b1"],

Cell[BoxData["1.6586052949325345`"], "Output",
 CellChangeTimes->{3.946128658740675*^9, 3.94612941551252*^9, 
  3.946129812470614*^9, 3.946130413126638*^9, 3.946130928329789*^9, 
  3.946132843952215*^9, 3.9461329401177063`*^9, 3.946133723559634*^9},
 CellLabel->
  "Out[1960]=",ExpressionUUID->"6b86bc1d-bb99-45ed-99f8-8d8df5b109c8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "0.8191414313131189`"}]], "Input",
 CellChangeTimes->{{3.94612516414155*^9, 
  3.946125164142489*^9}},ExpressionUUID->"d7dcbedb-dda0-43f6-8a87-\
97318bbd9e4f"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "0.8191414313131189`"}]], "Input",
 CellChangeTimes->{{3.946125164988282*^9, 
  3.9461251649893303`*^9}},ExpressionUUID->"fcf822b1-9231-4631-acf5-\
a86416aba808"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "1.3689800595509491`"}]], "Input",
 CellChangeTimes->{{3.946125165818006*^9, 
  3.9461251658186626`*^9}},ExpressionUUID->"16e3b582-2d9f-47ef-b2f0-\
92a0bf05a03f"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "1.24790412769891`"}]], "Input",
 CellChangeTimes->{{3.946125166781251*^9, 
  3.946125166782344*^9}},ExpressionUUID->"24fc681c-0221-4413-a153-\
989c6c903ab6"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "0.47086588702246357`"}]], "Input",
 CellChangeTimes->{{3.946125167790506*^9, 
  3.94612516779144*^9}},ExpressionUUID->"c43853c4-f774-4dc6-bb48-\
ba3e57747594"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "0.47086588702246357`"}]], "Input",
 CellChangeTimes->{{3.946125168621152*^9, 
  3.946125168622222*^9}},ExpressionUUID->"87fb549e-0302-4b8e-8951-\
f0cf14faae86"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "2.486703653743743`"}]], "Input",
 CellChangeTimes->{{3.946125170011551*^9, 
  3.94612517001243*^9}},ExpressionUUID->"022cd577-7634-41a0-9bae-\
53f9b00d04e8"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "1.5918333318028708`"}]], "Input",
 CellChangeTimes->{{3.946125171068459*^9, 
  3.946125171069503*^9}},ExpressionUUID->"b14f74d0-8d31-4878-a684-\
5fbe75df335e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"For", " ", "kappa"}], "=", 
     RowBox[{"2", "/", "b"}]}], ",", " ", 
    RowBox[{"epsilon", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", "7"}], " ", "dB", " ", "this", " ", "is", " ", "a", " ", 
      "good", " ", "good", " ", 
      RowBox[{"setting", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"delta", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"min", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Tau]", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"t", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "min", ",", "100", ",", "delta"}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p\[Tau]s", "=", 
     RowBox[{"\[Tau]", "/", 
      RowBox[{"(", 
       RowBox[{"1.", "+", "\[Tau]"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stable", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"1", "-", 
        RowBox[{"t", "/", "10."}]}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{"min", "-", "delta"}], ",", "delta"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AbsoluteTiming", "[", 
     RowBox[{"table", "=", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"stable", ",", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"kprobintegrand", "[", 
                RowBox[{
                 RowBox[{"{", "z1", "}"}], ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"z1", ",", "p\[Tau]", ",", "1"}], "}"}], ",", 
               RowBox[{"Method", "->", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", 
                  RowBox[{"\"\<SymbolicProcessing\>\"", "->", "0"}]}], 
                 "}"}]}], ",", 
               RowBox[{"MinRecursion", "->", "1"}], ",", 
               RowBox[{"AccuracyGoal", "->", "1"}], ",", 
               RowBox[{"PrecisionGoal", "->", "1"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"Ceiling", "[", 
                RowBox[{
                 RowBox[{"1", "/", "p\[Tau]"}], "-", "1", "-", "1"}], "]"}]}],
               "}"}]}], "]"}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"ICintegrand", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"z1", ",", "z2"}], "}"}], ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"z1", ",", "p\[Epsilon]", ",", "p\[Tau]"}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"z2", ",", "p\[Epsilon]", ",", "p\[Tau]"}], "}"}], 
               ",", 
               RowBox[{"Method", "->", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", 
                  RowBox[{"\"\<SymbolicProcessing\>\"", "->", "0"}]}], 
                 "}"}]}], ",", 
               RowBox[{"MinRecursion", "->", "2"}], ",", 
               RowBox[{"AccuracyGoal", "->", "1"}], ",", 
               RowBox[{"PrecisionGoal", "->", "1"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"Ceiling", "[", 
                RowBox[{
                 RowBox[{"1", "/", "p\[Epsilon]"}], "-", "2", "-", "1"}], 
                "]"}]}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"p\[Tau]", ",", "p\[Tau]s"}], "}"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"table", "=", 
     RowBox[{"Flatten", "[", "table", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AbsoluteTiming", "[", 
     RowBox[{"table1", "=", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"stable", ",", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"kprobintegrand", "[", 
                RowBox[{
                 RowBox[{"{", "z1", "}"}], ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"z1", ",", "p\[Tau]", ",", "1"}], "}"}], ",", 
               RowBox[{"Method", "->", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", 
                  RowBox[{"\"\<SymbolicProcessing\>\"", "->", "0"}]}], 
                 "}"}]}], ",", 
               RowBox[{"MinRecursion", "->", "1"}], ",", 
               RowBox[{"AccuracyGoal", "->", "1"}], ",", 
               RowBox[{"PrecisionGoal", "->", "1"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"Ceiling", "[", 
                RowBox[{
                 RowBox[{"1", "/", "p\[Tau]"}], "-", "1", "-", "1"}], "]"}]}],
               "}"}]}], "]"}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"SICintegrand", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"z1", ",", "z2"}], "}"}], ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"z1", ",", "p\[Epsilon]", ",", "p\[Tau]"}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"z2", ",", "p\[Epsilon]", ",", "p\[Tau]"}], "}"}], 
               ",", 
               RowBox[{"Method", "->", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", 
                  RowBox[{"\"\<SymbolicProcessing\>\"", "->", "0"}]}], 
                 "}"}]}], ",", 
               RowBox[{"MinRecursion", "->", "2"}], ",", 
               RowBox[{"AccuracyGoal", "->", "1"}], ",", 
               RowBox[{"PrecisionGoal", "->", "1"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"Ceiling", "[", 
                RowBox[{
                 RowBox[{"1", "/", "p\[Epsilon]"}], "-", "2"}], "]"}]}], 
              "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"p\[Tau]", ",", "p\[Tau]s"}], "}"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"table1", "=", 
     RowBox[{"Flatten", "[", "table1", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AbsoluteTiming", "[", 
     RowBox[{"table2", "=", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"stable", ",", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"kprobintegrand", "[", 
                RowBox[{
                 RowBox[{"{", "z1", "}"}], ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"z1", ",", "p\[Tau]", ",", "1"}], "}"}], ",", 
               RowBox[{"Method", "->", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", 
                  RowBox[{"\"\<SymbolicProcessing\>\"", "->", "0"}]}], 
                 "}"}]}], ",", 
               RowBox[{"MinRecursion", "->", "1"}], ",", 
               RowBox[{"AccuracyGoal", "->", "1"}], ",", 
               RowBox[{"PrecisionGoal", "->", "1"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"Ceiling", "[", 
                RowBox[{
                 RowBox[{"1", "/", "p\[Tau]"}], "-", "1", "-", "1"}], "]"}]}],
               "}"}]}], "]"}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"SICintegrand", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"z1", ",", "z2", ",", "z3"}], "}"}], ",", "i"}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"z1", ",", "0", ",", "p\[Tau]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"z2", ",", "0", ",", "p\[Tau]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"z3", ",", "0", ",", "p\[Tau]"}], "}"}], ",", 
               RowBox[{"Method", "->", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", 
                  RowBox[{"\"\<SymbolicProcessing\>\"", "->", "0"}]}], 
                 "}"}]}], ",", 
               RowBox[{"MinRecursion", "->", "2"}], ",", 
               RowBox[{"AccuracyGoal", "->", "1"}], ",", 
               RowBox[{"PrecisionGoal", "->", "1"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"Ceiling", "[", 
                RowBox[{
                 RowBox[{"1", "/", "p\[Epsilon]"}], "-", "2"}], "]"}]}], 
              "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"p\[Tau]", ",", "p\[Tau]s"}], "}"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"table2", "=", 
     RowBox[{"Flatten", "[", "table2", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AbsoluteTiming", "[", 
     RowBox[{"table3", "=", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"stable", ",", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"kprobintegrand", "[", 
                RowBox[{
                 RowBox[{"{", "z1", "}"}], ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"z1", ",", "p\[Tau]", ",", "1"}], "}"}], ",", 
               RowBox[{"Method", "->", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", 
                  RowBox[{"\"\<SymbolicProcessing\>\"", "->", "0"}]}], 
                 "}"}]}], ",", 
               RowBox[{"MinRecursion", "->", "1"}], ",", 
               RowBox[{"AccuracyGoal", "->", "1"}], ",", 
               RowBox[{"PrecisionGoal", "->", "1"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"Ceiling", "[", 
                RowBox[{
                 RowBox[{"1", "/", "p\[Tau]"}], "-", "1", "-", "1"}], "]"}]}],
               "}"}]}], "]"}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"SICintegrand", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"z1", ",", "z2", ",", "z3", ",", "z4"}], "}"}], ",",
                  "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"z1", ",", "0", ",", "p\[Tau]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"z2", ",", "0", ",", "p\[Tau]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"z3", ",", "0", ",", "p\[Tau]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"z4", ",", "0", ",", "p\[Tau]"}], "}"}], ",", 
               RowBox[{"Method", "->", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", 
                  RowBox[{"\"\<SymbolicProcessing\>\"", "->", "0"}]}], 
                 "}"}]}], ",", 
               RowBox[{"MinRecursion", "->", "2"}], ",", 
               RowBox[{"AccuracyGoal", "->", "1"}], ",", 
               RowBox[{"PrecisionGoal", "->", "1"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"Ceiling", "[", 
                RowBox[{
                 RowBox[{"1", "/", "p\[Epsilon]"}], "-", "2"}], "]"}]}], 
              "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"p\[Tau]", ",", "p\[Tau]s"}], "}"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"table3", "=", 
     RowBox[{"Flatten", "[", "table3", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Tau]", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"t", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"min", "-", "delta"}], ",", "delta"}], "}"}]}], "]"}], ",",
        "\[Tau]"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Tau]", "=", 
     RowBox[{"Flatten", "[", "\[Tau]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.945878754726355*^9, 3.945878791485734*^9}, {
   3.94587899252582*^9, 3.945879003753841*^9}, {3.945879044449003*^9, 
   3.945879046250714*^9}, {3.945879168972158*^9, 3.945879169466867*^9}, {
   3.945948819150896*^9, 3.9459488864083967`*^9}, 3.945948954496436*^9, {
   3.945949064328381*^9, 3.945949065934074*^9}, {3.9459491126025257`*^9, 
   3.945949138608964*^9}, {3.945949863320959*^9, 3.945949864619431*^9}, {
   3.9459499852863483`*^9, 3.9459499987167807`*^9}, {3.945950217172371*^9, 
   3.9459502348066053`*^9}, {3.945950772844338*^9, 3.945950801473053*^9}, {
   3.946114355850685*^9, 3.946114377460846*^9}, {3.9461146342301207`*^9, 
   3.946114649865547*^9}, {3.946114698219124*^9, 3.9461147250511293`*^9}, {
   3.946114831835615*^9, 3.946114831981633*^9}, {3.946115673637433*^9, 
   3.946115674721689*^9}, {3.946115732531769*^9, 3.946115752545872*^9}, {
   3.946115806851139*^9, 3.946115810928846*^9}, {3.946117779967667*^9, 
   3.946117810110149*^9}, {3.946117854927999*^9, 3.946117883324441*^9}, {
   3.946119374039857*^9, 3.946119376178321*^9}, {3.946120315831105*^9, 
   3.94612032174579*^9}, {3.946120688578697*^9, 3.946120688878379*^9}, 
   3.946121009352277*^9, {3.946121190689947*^9, 3.946121191962302*^9}, {
   3.946121255075405*^9, 3.946121255697384*^9}, 3.946121480261291*^9, {
   3.946121541252211*^9, 3.946121559571243*^9}, {3.9461215959092712`*^9, 
   3.946121639425096*^9}, {3.946121748307087*^9, 3.946121749920809*^9}, {
   3.946121884630821*^9, 3.946121884674449*^9}, {3.9461220313989487`*^9, 
   3.946122031573279*^9}, {3.946122239624127*^9, 3.946122239701521*^9}, {
   3.946122303064284*^9, 3.946122306485432*^9}, 3.946122418807847*^9, {
   3.946122632089635*^9, 3.946122632773107*^9}, 3.946122863309238*^9, {
   3.946123101790381*^9, 3.946123104841651*^9}, 3.946123349055777*^9, {
   3.9461238235698633`*^9, 3.9461238236491613`*^9}, {3.946125154579238*^9, 
   3.946125154929346*^9}, {3.946128897004038*^9, 3.946128897257894*^9}},
 CellLabel->
  "In[1938]:=",ExpressionUUID->"0b72f7e8-4b8d-413f-90ae-1d0a742a18a7"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "slwcon", 
   "\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"", None, 1949, 133, 
   27414895423451772057, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.946133397292129*^9},
 CellLabel->
  "(kernel 2)",ExpressionUUID->"74acd087-03c4-49ec-8479-627d8f42e890"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "slwcon", 
   "\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"", None, 1949, 134, 
   27414895423451772057, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.946133399825482*^9},
 CellLabel->
  "(kernel 2)",ExpressionUUID->"8d68f188-a222-442a-a906-40fd78a09fda"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "eincr", 
   "\"The global error of the strategy GlobalAdaptive has increased more than \
\\!\\(\\*RowBox[{\\\"2000\\\"}]\\) times. The global error is expected to \
decrease monotonically after a number of integrand evaluations. Suspect one \
of the following: the working precision is insufficient for the specified \
precision goal; the integrand is highly oscillatory or it is not a \
(piecewise) smooth function; or the true value of the integral is 0. \
Increasing the value of the GlobalAdaptive option MaxErrorIncreases might \
lead to a convergent numerical integration. NIntegrate obtained \
\\!\\(\\*RowBox[{\\\"0.7222584135160716`\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"0.11306752039742529`\\\"}]\\) for the integral and error \
estimates.\"", None, 1949, 135, 27414895423451772057, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.9461334035575657`*^9},
 CellLabel->
  "(kernel 2)",ExpressionUUID->"b2583a8c-35ac-416b-acd7-e964194f45b3"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "slwcon", 
   "\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"", None, 1949, 136, 
   27414895423451772057, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.946133405316025*^9},
 CellLabel->
  "(kernel 2)",ExpressionUUID->"7fc30a8c-43e9-4fcd-ba84-b7d6881b818e"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"slwcon\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", None, 1949, 137, 27414895423451772057, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.946133405351882*^9},
 CellLabel->
  "(kernel 2)",ExpressionUUID->"4362427e-32f1-4c00-ad24-c2b6646fc161"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "eincr", 
   "\"The global error of the strategy GlobalAdaptive has increased more than \
\\!\\(\\*RowBox[{\\\"2000\\\"}]\\) times. The global error is expected to \
decrease monotonically after a number of integrand evaluations. Suspect one \
of the following: the working precision is insufficient for the specified \
precision goal; the integrand is highly oscillatory or it is not a \
(piecewise) smooth function; or the true value of the integral is 0. \
Increasing the value of the GlobalAdaptive option MaxErrorIncreases might \
lead to a convergent numerical integration. NIntegrate obtained \
\\!\\(\\*RowBox[{\\\"-\\\", \\\"0.5202444532658559`\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"0.11501114532669524`\\\"}]\\) for the integral and error \
estimates.\"", None, 1949, 138, 27414895423451772057, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.9461334567130747`*^9},
 CellLabel->
  "(kernel 2)",ExpressionUUID->"df196813-c9ff-46fb-86ad-6a6c5281a921"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "eincr", 
   "\"The global error of the strategy GlobalAdaptive has increased more than \
\\!\\(\\*RowBox[{\\\"2000\\\"}]\\) times. The global error is expected to \
decrease monotonically after a number of integrand evaluations. Suspect one \
of the following: the working precision is insufficient for the specified \
precision goal; the integrand is highly oscillatory or it is not a \
(piecewise) smooth function; or the true value of the integral is 0. \
Increasing the value of the GlobalAdaptive option MaxErrorIncreases might \
lead to a convergent numerical integration. NIntegrate obtained \
\\!\\(\\*RowBox[{\\\"-\\\", \\\"0.49410628195403433`\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"0.10409943944275003`\\\"}]\\) for the integral and error \
estimates.\"", None, 1949, 139, 27414895423451772057, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.946133550786193*^9},
 CellLabel->
  "(kernel 2)",ExpressionUUID->"aab57f2a-9894-49b3-b216-7f773a62ff59"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"eincr\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", None, 1949, 140, 27414895423451772057, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.946133550813444*^9},
 CellLabel->
  "(kernel 2)",ExpressionUUID->"3169cc2f-db71-44b8-87b7-c6b91f66255e"]
}, Open  ]]
},
WindowSize->{614.25, 669},
WindowMargins->{{-921.75, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.0 for Linux x86 (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"692f80f2-4140-4ea8-867c-b11a84e8fece"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1086, 32, 110, "Input",ExpressionUUID->"841095ea-e8ff-4a44-a593-ef8388517744"],
Cell[CellGroupData[{
Cell[1669, 56, 2699, 59, 230, "Input",ExpressionUUID->"b1ee6303-df19-4b84-bcc3-8c8a9f781d4b"],
Cell[4371, 117, 241, 4, 47, "Output",ExpressionUUID->"6713235d-af39-43fb-8be8-540a2d39dd61"],
Cell[4615, 123, 241, 4, 47, "Output",ExpressionUUID->"f616e435-abb4-433a-a363-105cf4b5691f"],
Cell[4859, 129, 243, 4, 47, "Output",ExpressionUUID->"a3a0555e-e555-4827-8ebc-bcfc91f60f8d"],
Cell[5105, 135, 243, 4, 47, "Output",ExpressionUUID->"eefdb019-4209-4f49-90f1-afc9433db053"],
Cell[5351, 141, 240, 4, 47, "Output",ExpressionUUID->"13d1c6f7-b9b3-4abc-a5c4-719cc3cd4799"],
Cell[5594, 147, 239, 4, 69, "Output",ExpressionUUID->"f9e9be5e-099e-4e61-8b46-42beece3794a"]
}, Open  ]],
Cell[5848, 154, 221, 4, 50, "Input",ExpressionUUID->"aa059d93-b9c3-4e37-9d61-b01cedb0ba8a"],
Cell[6072, 160, 15780, 326, 931, "Input",ExpressionUUID->"ba68314b-d776-4989-a414-5168d8d4b5b8"],
Cell[21855, 488, 131, 3, 29, "Input",ExpressionUUID->"c8b4f572-025c-4aa7-ad6f-cd442cff7752"],
Cell[CellGroupData[{
Cell[22011, 495, 2321, 59, 310, "Input",ExpressionUUID->"b47da379-013d-43ea-b2f3-5bf2232b4ff4"],
Cell[24335, 556, 333, 5, 47, "Output",ExpressionUUID->"51ad0216-c330-4339-94b6-8d6b250842ef"],
Cell[24671, 563, 333, 5, 47, "Output",ExpressionUUID->"16c430d0-e736-4db6-9dbe-a315707cc2de"],
Cell[25007, 570, 333, 5, 47, "Output",ExpressionUUID->"ef278c5d-1257-4c23-b31c-ba2fb5e149e5"],
Cell[25343, 577, 335, 5, 47, "Output",ExpressionUUID->"06a5c56e-2121-4a19-b827-63f125066fef"],
Cell[25681, 584, 333, 5, 47, "Output",ExpressionUUID->"16bd6ed5-7f39-41d5-821f-26d05580b5d9"],
Cell[26017, 591, 335, 5, 47, "Output",ExpressionUUID->"2ced4743-9b4c-4a64-8f7c-4cf9a7597f12"],
Cell[26355, 598, 329, 5, 47, "Output",ExpressionUUID->"1a5715ca-c33b-42a0-ada5-8666f369e5b1"],
Cell[26687, 605, 333, 5, 47, "Output",ExpressionUUID->"6b86bc1d-bb99-45ed-99f8-8d8df5b109c8"]
}, Open  ]],
Cell[27035, 613, 205, 4, 50, "Input",ExpressionUUID->"d7dcbedb-dda0-43f6-8a87-97318bbd9e4f"],
Cell[27243, 619, 208, 4, 50, "Input",ExpressionUUID->"fcf822b1-9231-4631-acf5-a86416aba808"],
Cell[27454, 625, 208, 4, 50, "Input",ExpressionUUID->"16e3b582-2d9f-47ef-b2f0-92a0bf05a03f"],
Cell[27665, 631, 204, 4, 50, "Input",ExpressionUUID->"24fc681c-0221-4413-a153-989c6c903ab6"],
Cell[27872, 637, 206, 4, 50, "Input",ExpressionUUID->"c43853c4-f774-4dc6-bb48-ba3e57747594"],
Cell[28081, 643, 207, 4, 50, "Input",ExpressionUUID->"87fb549e-0302-4b8e-8951-f0cf14faae86"],
Cell[28291, 649, 204, 4, 50, "Input",ExpressionUUID->"022cd577-7634-41a0-9bae-53f9b00d04e8"],
Cell[28498, 655, 206, 4, 50, "Input",ExpressionUUID->"b14f74d0-8d31-4878-a684-5fbe75df335e"],
Cell[CellGroupData[{
Cell[28729, 663, 14982, 348, 1252, "Input",ExpressionUUID->"0b72f7e8-4b8d-413f-90ae-1d0a742a18a7"],
Cell[43714, 1013, 491, 11, 62, "Message",ExpressionUUID->"74acd087-03c4-49ec-8479-627d8f42e890"],
Cell[44208, 1026, 491, 11, 62, "Message",ExpressionUUID->"8d68f188-a222-442a-a906-40fd78a09fda"],
Cell[44702, 1039, 1037, 18, 158, "Message",ExpressionUUID->"b2583a8c-35ac-416b-acd7-e964194f45b3"],
Cell[45742, 1059, 491, 11, 62, "Message",ExpressionUUID->"7fc30a8c-43e9-4fcd-ba84-b7d6881b818e"],
Cell[46236, 1072, 464, 10, 23, "Message",ExpressionUUID->"4362427e-32f1-4c00-ad24-c2b6646fc161"],
Cell[46703, 1084, 1048, 18, 158, "Message",ExpressionUUID->"df196813-c9ff-46fb-86ad-6a6c5281a921"],
Cell[47754, 1104, 1047, 18, 158, "Message",ExpressionUUID->"aab57f2a-9894-49b3-b216-7f773a62ff59"],
Cell[48804, 1124, 463, 10, 23, "Message",ExpressionUUID->"3169cc2f-db71-44b8-87b7-c6b91f66255e"]
}, Open  ]]
}
]
*)

