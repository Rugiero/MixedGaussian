(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11942,        267]
NotebookOptionsPosition[     11311,        250]
NotebookOutlinePosition[     11705,        266]
CellTagsIndexPosition[     11662,        263]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TrapezoidalIntegration", "[", 
    RowBox[{"data_List", ",", "dx_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "sum"}], "}"}], ",", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sum", "=", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "+", 
        RowBox[{"2", "*", 
         RowBox[{"Total", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"dx", "/", "2"}], ")"}], "*", "sum"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellLabel->
  "In[101]:=",ExpressionUUID->"841095ea-e8ff-4a44-a593-ef8388517744"],

Cell[BoxData[{
 RowBox[{"TrapezoidalIntegration", "[", 
  RowBox[{"table1", ",", "delta"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"TrapezoidalIntegration", "[", 
  RowBox[{"table2", ",", "delta"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.943523483462543*^9, 3.9435235244681883`*^9}, 
   3.94352356805119*^9, 3.943523781653843*^9, {3.943525616405194*^9, 
   3.943525624915559*^9}, {3.943527612117895*^9, 3.943527636339199*^9}, {
   3.943527718223034*^9, 3.9435277199755793`*^9}, {3.94352823734722*^9, 
   3.9435282564994397`*^9}, {3.943529199885479*^9, 3.94352920016166*^9}, {
   3.943529398729306*^9, 3.94352939884242*^9}, 3.9435295539753523`*^9, {
   3.94353409337735*^9, 3.943534095687509*^9}, {3.9435373699989786`*^9, 
   3.94353737233613*^9}, {3.9435374216240067`*^9, 3.94353742300181*^9}, {
   3.943537463207874*^9, 3.943537463263458*^9}, 3.943538258877202*^9, {
   3.943538638494431*^9, 3.943538641879647*^9}, {3.943539578891369*^9, 
   3.943539580725632*^9}, {3.943539614564824*^9, 3.943539616318795*^9}, 
   3.943541884655417*^9},
 CellLabel->
  "In[113]:=",ExpressionUUID->"b1ee6303-df19-4b84-bcc3-8c8a9f781d4b"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"For", " ", "kappa"}], "=", 
     RowBox[{"2", "/", "b"}]}], ",", " ", 
    RowBox[{"epsilon", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", "7"}], " ", "dB", " ", "this", " ", "is", " ", "a", " ", 
      "good", " ", "good", " ", 
      RowBox[{"setting", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"delta", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Tau]", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"t", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0.2", ",", "100", ",", "delta"}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p\[Tau]s", "=", 
     RowBox[{"\[Tau]", "/", 
      RowBox[{"(", 
       RowBox[{"1.", "+", "\[Tau]"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"table1", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{"kprobintegrand", "[", 
            RowBox[{
             RowBox[{"{", "z1", "}"}], ",", "i"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"z1", ",", "p\[Tau]", ",", "1"}], "}"}], ",", 
           RowBox[{"Method", "->", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", 
              RowBox[{"\"\<SymbolicProcessing\>\"", "->", "1"}]}], "}"}]}], 
           ",", 
           RowBox[{"MinRecursion", "->", "1"}], ",", 
           RowBox[{"AccuracyGoal", "->", "1"}], ",", 
           RowBox[{"PrecisionGoal", "->", "1"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"Ceiling", "[", 
            RowBox[{
             RowBox[{"1", "/", "p\[Tau]"}], "-", "1", "-", "1"}], "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"p\[Tau]", ",", "p\[Tau]s"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"table2", "=", "\[IndentingNewLine]", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{"kprobintegrand", "[", 
             RowBox[{
              RowBox[{"{", "z1", "}"}], ",", "i"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"z1", ",", "p\[Tau]", ",", "1"}], "}"}], ",", 
            RowBox[{"Method", "->", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", 
               RowBox[{"\"\<SymbolicProcessing\>\"", "->", "1"}]}], "}"}]}], 
            ",", 
            RowBox[{"MinRecursion", "->", "1"}], ",", 
            RowBox[{"AccuracyGoal", "->", "1"}], ",", 
            RowBox[{"PrecisionGoal", "->", "1"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"Ceiling", "[", 
             RowBox[{
              RowBox[{"1", "/", "p\[Tau]"}], "-", "1", "-", "1"}], "]"}]}], 
           "}"}]}], "]"}], "+", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{"ICintegrand", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"z1", ",", "z2"}], "}"}], ",", "i"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"z1", ",", "p\[Epsilon]", ",", "p\[Tau]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z2", ",", "p\[Epsilon]", ",", "p\[Tau]"}], "}"}], ",", 
            RowBox[{"Method", "->", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", 
               RowBox[{"\"\<SymbolicProcessing\>\"", "->", "1"}]}], "}"}]}], 
            ",", 
            RowBox[{"MinRecursion", "->", "2"}], ",", 
            RowBox[{"AccuracyGoal", "->", "1"}], ",", 
            RowBox[{"PrecisionGoal", "->", "1"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"Ceiling", "[", 
             RowBox[{
              RowBox[{"1", "/", "p\[Epsilon]"}], "-", "2", "-", "1"}], 
             "]"}]}], "}"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"p\[Tau]", ",", "p\[Tau]s"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.943521152970832*^9, 3.943521175587902*^9}, {
   3.943521210911428*^9, 3.9435212161245203`*^9}, {3.943521263921122*^9, 
   3.943521317898288*^9}, {3.943521450068367*^9, 3.943521471373767*^9}, {
   3.943522191462724*^9, 3.94352222100518*^9}, {3.943522280425725*^9, 
   3.9435223253107243`*^9}, {3.943522357689878*^9, 3.943522361900292*^9}, {
   3.943522486542739*^9, 3.9435225135087748`*^9}, {3.943522583524704*^9, 
   3.943522641359263*^9}, {3.94352268564543*^9, 3.943522737573858*^9}, {
   3.943523270693336*^9, 3.94352329108509*^9}, {3.9435235056875286`*^9, 
   3.9435235358130007`*^9}, {3.943523619387968*^9, 3.943523639373708*^9}, 
   3.943523689414163*^9, {3.943523721395278*^9, 3.943523822736039*^9}, {
   3.943523954233135*^9, 3.943523975572586*^9}, {3.9435241419804087`*^9, 
   3.943524144118349*^9}, {3.943524179092342*^9, 3.943524219006843*^9}, 
   3.94352564167983*^9, 3.943525967458187*^9, 3.943526431724084*^9, 
   3.943526586385723*^9, {3.943527000749031*^9, 3.9435270008148813`*^9}, {
   3.943527260850241*^9, 3.943527261166953*^9}, {3.943527659807863*^9, 
   3.943527659974612*^9}, {3.943527704236084*^9, 3.943527715026548*^9}, {
   3.943527948059413*^9, 3.943527979580308*^9}, {3.9435281838638783`*^9, 
   3.9435281843650293`*^9}, 3.943528215331899*^9, 3.943528249114327*^9, 
   3.943528364057363*^9, 3.943529142726109*^9, {3.943529190600068*^9, 
   3.9435291912650437`*^9}, {3.943529386546229*^9, 3.943529392135866*^9}, {
   3.943529524146041*^9, 3.943529544408975*^9}, 3.943529767859383*^9, {
   3.943530985122524*^9, 3.943530985141109*^9}, {3.943531409115771*^9, 
   3.943531410149005*^9}, {3.943531668780034*^9, 3.943531668917923*^9}, 
   3.943532897960033*^9, {3.943534056700036*^9, 3.943534072223324*^9}, {
   3.943536711276416*^9, 3.943536711338254*^9}, {3.943537111529127*^9, 
   3.943537113896467*^9}, {3.943537391312725*^9, 3.943537443613468*^9}, {
   3.943537474326044*^9, 3.943537479880468*^9}, {3.94353758428975*^9, 
   3.943537584466261*^9}, 3.943537851407588*^9, {3.943537908056069*^9, 
   3.9435379110403233`*^9}, {3.943538274662773*^9, 3.943538279843547*^9}, 
   3.943538417547443*^9, {3.943538627951945*^9, 3.943538629324038*^9}, {
   3.943538719840242*^9, 3.943538720215996*^9}, {3.94353918919563*^9, 
   3.9435391893235083`*^9}, {3.943539425620553*^9, 3.943539455610519*^9}, {
   3.943539534809307*^9, 3.943539611591221*^9}, {3.943539654229601*^9, 
   3.943539686573121*^9}, {3.943539735548325*^9, 3.943539744316552*^9}, {
   3.943539813406772*^9, 3.943539813446265*^9}, {3.943540129721672*^9, 
   3.943540164767027*^9}, {3.9435402012524858`*^9, 3.943540216859991*^9}, 
   3.943540256049973*^9, {3.9435404246421013`*^9, 3.943540426396223*^9}, {
   3.943540595748618*^9, 3.9435405964212728`*^9}, 3.943540965766964*^9, {
   3.9435411986289*^9, 3.943541202432184*^9}, {3.943541789951641*^9, 
   3.9435418169851*^9}, 3.94354187243655*^9, {3.943541934204978*^9, 
   3.9435419348280373`*^9}, {3.94354196611441*^9, 3.943541966204404*^9}, {
   3.943542058055639*^9, 3.943542058147928*^9}, {3.943542268020535*^9, 
   3.94354226810563*^9}, {3.94354276114318*^9, 3.9435427651362557`*^9}, {
   3.943542797594033*^9, 3.943542847311115*^9}, {3.943542911402528*^9, 
   3.943542965931068*^9}, 3.943543342274666*^9, 3.943543377381887*^9, 
   3.943546053181684*^9, {3.9435472047749662`*^9, 3.943547204887936*^9}, {
   3.943547649091826*^9, 3.943547650954145*^9}, 3.9435484263163233`*^9, 
   3.943548866317511*^9, {3.943549880981144*^9, 3.943549881831395*^9}, {
   3.943550263542422*^9, 3.943550269295109*^9}, {3.943551467603479*^9, 
   3.9435514677928147`*^9}, {3.943551835817751*^9, 3.94355183656152*^9}, {
   3.943552222140199*^9, 3.9435522244523706`*^9}, {3.943593951967042*^9, 
   3.9435939593005543`*^9}, {3.943594005998407*^9, 3.9435940185137033`*^9}, 
   3.9435951558573647`*^9},ExpressionUUID->"ba68314b-d776-4989-a414-\
5168d8d4b5b8"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.943521475919711*^9, 3.943521481595442*^9}, {
   3.94352165896634*^9, 3.943521659442115*^9}, 
   3.9435263406474037`*^9},ExpressionUUID->"a274e9a9-73eb-4f40-ac2a-\
e69071e50630"]
},
WindowSize->{576, 673.5},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"14.0 for Linux x86 (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"692f80f2-4140-4ea8-867c-b11a84e8fece"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1086, 32, 110, "Input",ExpressionUUID->"841095ea-e8ff-4a44-a593-ef8388517744"],
Cell[1647, 54, 1146, 18, 70, "Input",ExpressionUUID->"b1ee6303-df19-4b84-bcc3-8c8a9f781d4b"],
Cell[2796, 74, 8282, 168, 551, "Input",ExpressionUUID->"ba68314b-d776-4989-a414-5168d8d4b5b8"],
Cell[11081, 244, 226, 4, 29, "Input",ExpressionUUID->"a274e9a9-73eb-4f40-ac2a-e69071e50630"]
}
]
*)

