(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     31714,        721]
NotebookOptionsPosition[     30428,        694]
NotebookOutlinePosition[     30827,        710]
CellTagsIndexPosition[     30784,        707]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.940069421706723*^9, 3.940069424618468*^9}, 
   3.9400696559816647`*^9, 3.944920232793926*^9},
 CellLabel->
  "In[595]:=",ExpressionUUID->"9c6f4dba-0d3e-45cc-80eb-61266fb1e382"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"momentmeasureintegrand", "[", 
     RowBox[{"t_List", ",", "v_List"}], "]"}], 
    "\[NonBreakingSpace]\[NonBreakingSpace]", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "hatTn", ",", "\[Xi]", ",", "g", ",", "listProduct", ",", 
        "\[ScriptCapitalL]D", ",", "\[ScriptCapitalL]I", " ", ",", 
        "\[ScriptCapitalL]W"}], "}"}], " ", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"listProduct", "[", "x_List", "]"}], " ", ":=", 
        RowBox[{"Times", " ", "@@", " ", "x"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"hatTn", "=", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Total", "[", "t", "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Xi]", "=", 
        RowBox[{"Total", "[", 
         RowBox[{"t", "*", "v"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[ScriptCapitalL]W", "=", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "w"}], "*", "hatTn", "*", "\[Xi]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[ScriptCapitalL]I", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"hatTn", "*", "\[Xi]"}]}], ")"}], "^", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"\[Kappa]", "*", "b"}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "[", "j_", "]"}], ":=", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"t", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "*", 
                RowBox[{"v", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "+", 
               RowBox[{"hatTn", "*", 
                RowBox[{"t", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "\[Xi]"}]}], ")"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "t", "]"}]}], "}"}]}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"t", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"v", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "+", 
             RowBox[{"hatTn", "*", 
              RowBox[{"t", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "\[Xi]"}]}], ")"}]}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[ScriptCapitalL]D", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"listProduct", "[", "t", "]"}], "/", "\[Xi]"}], "*", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"g", "[", "j", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "t", "]"}]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Kappa]", "*", "b"}], ")"}], "^", 
         RowBox[{"Length", "[", "t", "]"}]}], "*", "\[ScriptCapitalL]W", "*", 
        "\[ScriptCapitalL]I", "*", "\[ScriptCapitalL]D"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"paritalmomentmeasuredensity", "[", 
     RowBox[{"z_List", ",", "i_"}], "]"}], "\[NonBreakingSpace]", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "variables", ",", "limits"}], "}"}], " ", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", "z", "]"}], "+", 
          RowBox[{"i", "*", 
           RowBox[{"z", "[", 
            RowBox[{"[", 
             RowBox[{"Length", "[", "z", "]"}], "]"}], "]"}]}]}], ">=", "1"}],
         ",", "0", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "=", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Symbol", "[", 
              RowBox[{"\"\<v\>\"", "<>", 
               RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], ",", 
            RowBox[{
             RowBox[{"Length", "[", "z", "]"}], "+", "i"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"limits", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"v", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", "1", ",", "Infinity"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{
               RowBox[{"Length", "[", "z", "]"}], "+", "i"}]}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", "i"}], "*", 
          RowBox[{
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{"integrands", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"Sequence", "@@", "limits"}], "]"}], ",", 
             RowBox[{"Method", "->", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", 
                RowBox[{"\"\<SymbolicProcessing\>\"", "->", "1"}]}], "}"}]}], 
             ",", 
             RowBox[{"AccuracyGoal", "->", "1"}], ",", 
             RowBox[{"PrecisionGoal", "->", "1"}]}], "]"}], "/", 
           RowBox[{"i", "!"}]}]}]}]}], " ", "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kprobintegrandmomentmeasure", "[", 
     RowBox[{"z_List", ",", "i_"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"AllTrue", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"z", ",", "2", ",", "1"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ">", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"paritalmomentmeasuredensity", "[", 
       RowBox[{"z", ",", "i"}], "]"}], "\[IndentingNewLine]", ",", "0"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.940068992487524*^9, 3.940069078778075*^9}, {
   3.9400691188096743`*^9, 3.940069352428257*^9}, {3.94006940772742*^9, 
   3.9400694465700893`*^9}, {3.940069543727663*^9, 3.940069557055311*^9}, {
   3.940069591441382*^9, 3.940069591776373*^9}, {3.940069657584431*^9, 
   3.940069657985623*^9}, {3.940069824604492*^9, 3.940069829358587*^9}, {
   3.940069866609272*^9, 3.940069875168997*^9}, {3.940070041298601*^9, 
   3.940070068577833*^9}, {3.940070189042914*^9, 3.940070195623665*^9}, {
   3.940070244692482*^9, 3.9400703325611477`*^9}, {3.944919704376467*^9, 
   3.944919704536521*^9}, {3.944919774028796*^9, 3.9449197779183717`*^9}, {
   3.944920080811009*^9, 3.944920100283741*^9}, {3.944920134315576*^9, 
   3.944920152954618*^9}, {3.944920214378685*^9, 3.944920232045192*^9}, {
   3.944920265391553*^9, 3.944920335725903*^9}, {3.944920400061214*^9, 
   3.944920423513263*^9}, 3.944920577872039*^9, {3.94508711868289*^9, 
   3.945087118842552*^9}, 3.945087282006755*^9, {3.945087806298636*^9, 
   3.945087931002709*^9}, 3.945088025621152*^9, {3.945088452205614*^9, 
   3.94508846278933*^9}, {3.945088511477584*^9, 3.945088539664275*^9}, 
   3.945088575063731*^9, {3.945088632092642*^9, 3.945088634064906*^9}, {
   3.945088777068853*^9, 3.9450887776782827`*^9}, {3.9450888518458548`*^9, 
   3.9450888537295647`*^9}, {3.945088893898177*^9, 3.945089028893447*^9}, {
   3.945089112534442*^9, 3.945089147161275*^9}, {3.945089354736173*^9, 
   3.945089354900592*^9}, {3.945089677390712*^9, 3.945089678136826*^9}, {
   3.9450898091911297`*^9, 3.945089840638157*^9}, 3.945089979488372*^9, {
   3.945090019024785*^9, 3.945090061056209*^9}, {3.945090520127833*^9, 
   3.945090551967272*^9}, {3.945090585239717*^9, 3.945090588380203*^9}, {
   3.945092914875218*^9, 3.945092918916182*^9}, {3.945092953917718*^9, 
   3.945092959108279*^9}, {3.945093006439795*^9, 3.9450930481596007`*^9}, {
   3.9450931010037107`*^9, 3.945093125231386*^9}, {3.945093175541359*^9, 
   3.94509322351612*^9}, {3.945093301485235*^9, 3.945093304679702*^9}, {
   3.945093429297647*^9, 3.945093541563191*^9}, 3.945093888825536*^9, {
   3.945094142593782*^9, 3.945094150530365*^9}, {3.9450942393581057`*^9, 
   3.945094254913051*^9}, {3.945094327707446*^9, 3.945094349404947*^9}, {
   3.945094381643317*^9, 3.945094393624731*^9}, {3.945097111394926*^9, 
   3.945097151355937*^9}, {3.9450985262128477`*^9, 3.94509853655731*^9}, {
   3.945103342078995*^9, 3.945103344303636*^9}, 3.9451037160777082`*^9, {
   3.945104048713787*^9, 3.945104197528145*^9}, {3.94510463721973*^9, 
   3.945104728848583*^9}, {3.945104886481399*^9, 3.945104937728594*^9}, {
   3.945104968745555*^9, 3.9451050034071093`*^9}, 3.945105037859838*^9, 
   3.945106599517414*^9, {3.94510663031038*^9, 3.945106639233927*^9}, {
   3.945107019082155*^9, 3.945107045135057*^9}, {3.945107083107109*^9, 
   3.945107083700912*^9}, 3.945107147758291*^9, {3.9451072206073656`*^9, 
   3.945107230481282*^9}, {3.945107489163726*^9, 3.945107535093354*^9}, {
   3.945108045066959*^9, 3.945108047560355*^9}, {3.945109606466229*^9, 
   3.945109691039858*^9}, {3.945109734089958*^9, 3.945109756413239*^9}, {
   3.9451097940032797`*^9, 3.945109816597327*^9}, {3.9451098557540483`*^9, 
   3.945109859128623*^9}, {3.945109900434387*^9, 3.945109970999449*^9}, {
   3.945110022546278*^9, 3.94511004704452*^9}, {3.945110102251687*^9, 
   3.945110129147724*^9}, {3.945110300937407*^9, 3.945110307308619*^9}, {
   3.945110469685396*^9, 3.945110475367779*^9}, 3.945111558182788*^9, {
   3.945111610872389*^9, 3.94511163755092*^9}, {3.945111755156948*^9, 
   3.945111764426098*^9}, {3.945111872439599*^9, 3.945111873872015*^9}, {
   3.945112022019916*^9, 3.945112041928485*^9}, {3.945112115579542*^9, 
   3.945112124233289*^9}, {3.945112239127534*^9, 3.945112242967073*^9}, {
   3.945112314013719*^9, 3.945112314314534*^9}, {3.945112899491004*^9, 
   3.945112899804093*^9}, {3.945113055662744*^9, 3.945113058956751*^9}, {
   3.945113089898966*^9, 3.945113206428259*^9}, {3.9451132665919533`*^9, 
   3.945113274770509*^9}, {3.945113339764168*^9, 3.945113358641055*^9}, {
   3.945113455477734*^9, 3.9451134761799*^9}, {3.945114299420375*^9, 
   3.94511442367797*^9}, {3.945114521039056*^9, 3.945114521274222*^9}, {
   3.945114582978199*^9, 3.945114587082067*^9}, {3.945115006175584*^9, 
   3.945115039839203*^9}, {3.945115073603096*^9, 3.94511507568981*^9}, {
   3.945115779859449*^9, 3.94511578014016*^9}, {3.945115938224861*^9, 
   3.945115951197324*^9}, {3.945116265350734*^9, 3.945116271150163*^9}, {
   3.9451163717747397`*^9, 3.945116373402505*^9}, {3.945116448980444*^9, 
   3.94511645528132*^9}, {3.94511649359131*^9, 3.9451165083260193`*^9}, 
   3.945117801612376*^9, 3.945182140015317*^9, {3.945183308909911*^9, 
   3.9451833111338453`*^9}, {3.945184986027258*^9, 3.94518502204202*^9}, {
   3.9451862535931253`*^9, 3.9451862566228733`*^9}, 3.9451862962023697`*^9},
 CellLabel->
  "In[856]:=",ExpressionUUID->"a7f0068a-da9d-443b-8853-5712d65560a8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"paritalmomentmeasuredensity", "[", 
   RowBox[{
    RowBox[{"{", "0.2", "}"}], ",", "1"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partialdens", "[", 
   RowBox[{
    RowBox[{"{", "0.2", "}"}], ",", "1"}], "]"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.945111564320235*^9, 3.945111585076146*^9}, {
   3.945111646733945*^9, 3.9451116507785482`*^9}, {3.945111767480473*^9, 
   3.945111781065003*^9}, {3.945111833494619*^9, 3.94511186340097*^9}, {
   3.9451118975369806`*^9, 3.945111920041384*^9}, {3.9451121339824247`*^9, 
   3.945112140129912*^9}, {3.945112295104555*^9, 3.945112303820195*^9}, {
   3.945112362487653*^9, 3.9451123716132183`*^9}, {3.945112878451088*^9, 
   3.945112878874629*^9}, {3.9451129432860394`*^9, 3.945113051134551*^9}, {
   3.945113231039022*^9, 3.945113236905755*^9}, {3.94511460868498*^9, 
   3.9451146112347517`*^9}, {3.945114657854701*^9, 3.945114660926494*^9}, {
   3.9451147196616096`*^9, 3.945114738703318*^9}, {3.945115401122501*^9, 
   3.945115420911318*^9}, {3.9451154807389803`*^9, 3.945115485635791*^9}, 
   3.945115960819974*^9, {3.945116531242969*^9, 3.945116551574238*^9}, {
   3.945117104433322*^9, 3.9451171517053976`*^9}, {3.945117764435268*^9, 
   3.945117780001237*^9}},
 CellLabel->
  "In[3362]:=",ExpressionUUID->"f6170f69-a3a9-47fb-8067-bd321b98be0d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.008919`", ",", 
   RowBox[{"-", "6.060185388275594`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9451154106747828`*^9, 3.945115421193553*^9}, {
   3.9451154866260347`*^9, 3.945115499149887*^9}, 3.9451156390778637`*^9, {
   3.9451157847518067`*^9, 3.945115793183374*^9}, 3.945115873905723*^9, 
   3.9451159814846087`*^9, {3.9451165264631166`*^9, 3.945116552288131*^9}, {
   3.945117109617015*^9, 3.945117152687643*^9}, 3.945117781333668*^9},
 CellLabel->
  "Out[3362]=",ExpressionUUID->"24855cfe-42e6-4d19-8280-76666e3eb5a3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.009743`", ",", 
   RowBox[{"-", "6.0624266119304755`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9451154106747828`*^9, 3.945115421193553*^9}, {
   3.9451154866260347`*^9, 3.945115499149887*^9}, 3.9451156390778637`*^9, {
   3.9451157847518067`*^9, 3.945115793183374*^9}, 3.945115873905723*^9, 
   3.9451159814846087`*^9, {3.9451165264631166`*^9, 3.945116552288131*^9}, {
   3.945117109617015*^9, 3.945117152687643*^9}, 3.945117781334989*^9},
 CellLabel->
  "Out[3363]=",ExpressionUUID->"a6a0de0f-0a30-451c-805b-0f73fa968211"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Tau]", "=", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "7."}], "/", "10"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p\[Tau]", "=", 
     RowBox[{"\[Tau]", "/", 
      RowBox[{"(", 
       RowBox[{"1.", "+", "\[Tau]"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"imax", "=", 
     RowBox[{"Ceiling", "[", 
      RowBox[{
       RowBox[{"1", "/", "p\[Tau]"}], "-", "1", "-", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"kprobintegrand", "[", 
         RowBox[{
          RowBox[{"{", "z1", "}"}], ",", "i"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"z1", ",", "p\[Tau]", ",", "1"}], "}"}], ",", 
        RowBox[{"Method", "->", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"\"\<SymbolicProcessing\>\"", "->", "1"}]}], "}"}]}], ",", 
        
        RowBox[{"MinRecursion", "->", "1"}], ",", 
        RowBox[{"AccuracyGoal", "->", "2"}], ",", 
        RowBox[{"PrecisionGoal", "->", "2"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "imax"}], "}"}]}], "]"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Initialize", " ", "the", " ", "global", " ", "integrands"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dim", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integrands", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"z", "=", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<z\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], ",", 
           "dim"}], "]"}]}], ";", 
        RowBox[{"z", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"z", ",", 
           RowBox[{"Array", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Symbol", "[", 
               RowBox[{"\"\<z\>\"", "<>", 
                RowBox[{"ToString", "[", "dim", "]"}]}], "]"}], "&"}], ",", 
             "i"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"v", "=", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<v\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], ",", 
           RowBox[{"dim", "+", "i"}]}], "]"}]}], ";", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", "dim"}], "*", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{"1", ",", "dim"}], "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{"0", ",", "i"}], "]"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", 
               RowBox[{"i", "+", "dim"}]}], "]"}]}], "]"}], "[", 
           "momentmeasureintegrand", "]"}], "[", 
          RowBox[{"z", ",", "v"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "imax"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"imax", "=", 
     RowBox[{"Ceiling", "[", 
      RowBox[{
       RowBox[{"1", "/", "p\[Tau]"}], "-", "1", "-", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"kprobintegrandmomentmeasure", "[", 
         RowBox[{
          RowBox[{"{", "z1", "}"}], ",", "i"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"z1", ",", "p\[Tau]", ",", "1"}], "}"}], ",", 
        RowBox[{"Method", "->", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"\"\<SymbolicProcessing\>\"", "->", "1"}]}], "}"}]}], ",", 
        
        RowBox[{"MinRecursion", "->", "1"}], ",", 
        RowBox[{"AccuracyGoal", "->", "2"}], ",", 
        RowBox[{"PrecisionGoal", "->", "2"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "imax"}], "}"}]}], "]"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"imax", "=", 
     RowBox[{"Ceiling", "[", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"\[Tau]", "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Tau]"}], ")"}]}], ")"}]}], "-", "2", "-", 
       "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"kprobintegrand", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z1", ",", "z2"}], "}"}], ",", "i"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"z1", ",", 
          RowBox[{"\[Tau]", "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Tau]"}], ")"}]}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z2", ",", 
          RowBox[{"\[Tau]", "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Tau]"}], ")"}]}], ",", "1"}], "}"}], ",", 
        RowBox[{"Method", "->", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"\"\<SymbolicProcessing\>\"", "->", "1"}]}], "}"}]}], ",", 
        
        RowBox[{"MinRecursion", "->", "3"}], ",", 
        RowBox[{"AccuracyGoal", "->", "1"}], ",", 
        RowBox[{"PrecisionGoal", "->", "1"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "imax"}], "}"}]}], "]"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"imax", "=", 
     RowBox[{"Ceiling", "[", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"\[Tau]", "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Tau]"}], ")"}]}], ")"}]}], "-", "2", "-", 
       "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Initialize", " ", "the", " ", "global", " ", "integrands"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dim", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integrands", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"z", "=", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<z\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], ",", 
           "dim"}], "]"}]}], ";", 
        RowBox[{"z", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"z", ",", 
           RowBox[{"Array", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Symbol", "[", 
               RowBox[{"\"\<z\>\"", "<>", 
                RowBox[{"ToString", "[", "dim", "]"}]}], "]"}], "&"}], ",", 
             "i"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"v", "=", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<v\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], ",", 
           RowBox[{"dim", "+", "i"}]}], "]"}]}], ";", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", "dim"}], "*", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{"1", ",", "dim"}], "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{"0", ",", "i"}], "]"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", 
               RowBox[{"i", "+", "dim"}]}], "]"}]}], "]"}], "[", 
           "momentmeasureintegrand", "]"}], "[", 
          RowBox[{"z", ",", "v"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "imax"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"kprobintegrandmomentmeasure", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z1", ",", "z2"}], "}"}], ",", "i"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"z1", ",", 
          RowBox[{"\[Tau]", "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Tau]"}], ")"}]}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z2", ",", 
          RowBox[{"\[Tau]", "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Tau]"}], ")"}]}], ",", "1"}], "}"}], ",", 
        RowBox[{"Method", "->", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"\"\<SymbolicProcessing\>\"", "->", "1"}]}], "}"}]}], ",", 
        
        RowBox[{"MinRecursion", "->", "5"}], ",", 
        RowBox[{"AccuracyGoal", "->", "1"}], ",", 
        RowBox[{"PrecisionGoal", "->", "1"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "imax"}], "}"}]}], "]"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.945115259549642*^9, 3.945115264881385*^9}, {
   3.9451153280180187`*^9, 3.9451153285962553`*^9}, {3.945115383818149*^9, 
   3.9451153868027554`*^9}, 3.945115561343652*^9, {3.945115722761823*^9, 
   3.945115743459897*^9}, {3.945116077996475*^9, 3.945116186271385*^9}, {
   3.945116295509606*^9, 3.945116295978404*^9}, {3.945116349073667*^9, 
   3.945116356433107*^9}, {3.94511642388212*^9, 3.945116429751153*^9}, {
   3.945116595117099*^9, 3.945116595326725*^9}, {3.945116627928062*^9, 
   3.9451166753183813`*^9}, {3.94511674205862*^9, 3.945116748994587*^9}, {
   3.945116927147488*^9, 3.945116968434924*^9}, {3.9451171897636423`*^9, 
   3.945117192188598*^9}, {3.94511768693817*^9, 3.9451177000766*^9}, {
   3.945180187039729*^9, 3.945180206831203*^9}, {3.9451804849774857`*^9, 
   3.945180486351163*^9}, {3.9451805193591547`*^9, 3.945180576128203*^9}, 
   3.945180730659151*^9, {3.945180903720042*^9, 3.945180920053771*^9}, {
   3.945180960902555*^9, 3.945180982471156*^9}, {3.94518103401239*^9, 
   3.9451810517718687`*^9}, 3.945181095532737*^9, {3.945183043504086*^9, 
   3.945183043950507*^9}, {3.94518309939043*^9, 3.945183107615217*^9}, {
   3.9451835462726917`*^9, 3.945183551503788*^9}, 3.945183821745386*^9, {
   3.945184947085525*^9, 3.945184949078277*^9}, {3.945185142840109*^9, 
   3.94518514900218*^9}},
 CellLabel->
  "In[860]:=",ExpressionUUID->"2c62d80d-888c-498d-84a0-9fd481cb0b6f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.376837`", ",", "0.9986947721393308`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.945116186667087*^9, {3.945116276809779*^9, 3.945116296606302*^9}, {
   3.945116350177476*^9, 3.945116362555496*^9}, 3.945116430140239*^9, {
   3.945116479567479*^9, 3.945116511797256*^9}, 3.9451165963750567`*^9, {
   3.945116628711165*^9, 3.945116677674336*^9}, 3.945116752020791*^9, {
   3.945116935700098*^9, 3.9451169791039047`*^9}, 3.945117702579192*^9, 
   3.945117807574095*^9, 3.9451797206811953`*^9, 3.9451802082861233`*^9, 
   3.9451804425593224`*^9, 3.945180488356533*^9, {3.9451805213969603`*^9, 
   3.9451805343937607`*^9}, 3.945180593387987*^9, 3.9451807329029837`*^9, {
   3.9451809071810007`*^9, 3.945180920401368*^9}, {3.945180961897908*^9, 
   3.945180983247518*^9}, {3.945181034975685*^9, 3.945181053544978*^9}, 
   3.94518109833114*^9, 3.9451831224690733`*^9, 3.94518511668507*^9, 
   3.945185211275964*^9, 3.9451863300540733`*^9},
 CellLabel->
  "Out[863]=",ExpressionUUID->"bdfda0bc-fc97-4460-9801-022f5ced4fe8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.699487`", ",", "0.9716489033786536`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.945116186667087*^9, {3.945116276809779*^9, 3.945116296606302*^9}, {
   3.945116350177476*^9, 3.945116362555496*^9}, 3.945116430140239*^9, {
   3.945116479567479*^9, 3.945116511797256*^9}, 3.9451165963750567`*^9, {
   3.945116628711165*^9, 3.945116677674336*^9}, 3.945116752020791*^9, {
   3.945116935700098*^9, 3.9451169791039047`*^9}, 3.945117702579192*^9, 
   3.945117807574095*^9, 3.9451797206811953`*^9, 3.9451802082861233`*^9, 
   3.9451804425593224`*^9, 3.945180488356533*^9, {3.9451805213969603`*^9, 
   3.9451805343937607`*^9}, 3.945180593387987*^9, 3.9451807329029837`*^9, {
   3.9451809071810007`*^9, 3.945180920401368*^9}, {3.945180961897908*^9, 
   3.945180983247518*^9}, {3.945181034975685*^9, 3.945181053544978*^9}, 
   3.94518109833114*^9, 3.9451831224690733`*^9, 3.94518511668507*^9, 
   3.945185211275964*^9, 3.945186334767716*^9},
 CellLabel->
  "Out[867]=",ExpressionUUID->"df8c9eb8-7f6b-4059-9286-10605146ef8d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.486765`", ",", "0.5924158646725209`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.945116186667087*^9, {3.945116276809779*^9, 3.945116296606302*^9}, {
   3.945116350177476*^9, 3.945116362555496*^9}, 3.945116430140239*^9, {
   3.945116479567479*^9, 3.945116511797256*^9}, 3.9451165963750567`*^9, {
   3.945116628711165*^9, 3.945116677674336*^9}, 3.945116752020791*^9, {
   3.945116935700098*^9, 3.9451169791039047`*^9}, 3.945117702579192*^9, 
   3.945117807574095*^9, 3.9451797206811953`*^9, 3.9451802082861233`*^9, 
   3.9451804425593224`*^9, 3.945180488356533*^9, {3.9451805213969603`*^9, 
   3.9451805343937607`*^9}, 3.945180593387987*^9, 3.9451807329029837`*^9, {
   3.9451809071810007`*^9, 3.945180920401368*^9}, {3.945180961897908*^9, 
   3.945180983247518*^9}, {3.945181034975685*^9, 3.945181053544978*^9}, 
   3.94518109833114*^9, 3.9451831224690733`*^9, 3.94518511668507*^9, 
   3.945185211275964*^9, 3.9451863362552423`*^9},
 CellLabel->
  "Out[869]=",ExpressionUUID->"1581e023-cf3a-47e2-a521-64de08d9e888"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"366.798563`", ",", "0.6183340631606965`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.945116186667087*^9, {3.945116276809779*^9, 3.945116296606302*^9}, {
   3.945116350177476*^9, 3.945116362555496*^9}, 3.945116430140239*^9, {
   3.945116479567479*^9, 3.945116511797256*^9}, 3.9451165963750567`*^9, {
   3.945116628711165*^9, 3.945116677674336*^9}, 3.945116752020791*^9, {
   3.945116935700098*^9, 3.9451169791039047`*^9}, 3.945117702579192*^9, 
   3.945117807574095*^9, 3.9451797206811953`*^9, 3.9451802082861233`*^9, 
   3.9451804425593224`*^9, 3.945180488356533*^9, {3.9451805213969603`*^9, 
   3.9451805343937607`*^9}, 3.945180593387987*^9, 3.9451807329029837`*^9, {
   3.9451809071810007`*^9, 3.945180920401368*^9}, {3.945180961897908*^9, 
   3.945180983247518*^9}, {3.945181034975685*^9, 3.945181053544978*^9}, 
   3.94518109833114*^9, 3.9451831224690733`*^9, 3.94518511668507*^9, 
   3.945185211275964*^9, 3.945186703169528*^9},
 CellLabel->
  "Out[873]=",ExpressionUUID->"66180b08-bb6e-417a-b3d3-b518070cf05f"]
}, Open  ]]
},
WindowSize->{614.25, 669},
WindowMargins->{{-1536, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.0 for Linux x86 (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8c20b42b-b272-4040-aa0e-25f3eaafb87f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 272, 5, 29, "Input",ExpressionUUID->"9c6f4dba-0d3e-45cc-80eb-61266fb1e382"],
Cell[833, 27, 11698, 243, 729, "Input",ExpressionUUID->"a7f0068a-da9d-443b-8853-5712d65560a8"],
Cell[CellGroupData[{
Cell[12556, 274, 1397, 26, 50, "Input",ExpressionUUID->"f6170f69-a3a9-47fb-8067-bd321b98be0d"],
Cell[13956, 302, 567, 10, 33, "Output",ExpressionUUID->"24855cfe-42e6-4d19-8280-76666e3eb5a3"],
Cell[14526, 314, 568, 10, 33, "Output",ExpressionUUID->"a6a0de0f-0a30-451c-805b-0f73fa968211"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15131, 329, 11043, 286, 991, "Input",ExpressionUUID->"2c62d80d-888c-498d-84a0-9fd481cb0b6f"],
Cell[26177, 617, 1057, 17, 33, "Output",ExpressionUUID->"bdfda0bc-fc97-4460-9801-022f5ced4fe8"],
Cell[27237, 636, 1055, 17, 33, "Output",ExpressionUUID->"df8c9eb8-7f6b-4059-9286-10605146ef8d"],
Cell[28295, 655, 1057, 17, 33, "Output",ExpressionUUID->"1581e023-cf3a-47e2-a521-64de08d9e888"],
Cell[29355, 674, 1057, 17, 55, "Output",ExpressionUUID->"66180b08-bb6e-417a-b3d3-b518070cf05f"]
}, Open  ]]
}
]
*)

