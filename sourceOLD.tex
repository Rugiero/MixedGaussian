\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first footnote. If that is unneeded, please comment it out.
\usepackage{amsthm}
\usepackage{longtable}
\usepackage{upgreek}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{graphicx} 
\usepackage{gensymb}
\usepackage{hyperref}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{dsfont}
%\usepackage{amsfonts}
%\usepackage{bbold}
\newcommand{\rEarth}{R_{\oplus}}
\newcommand{\viiva}{\mathop{\Bigg/}}
\newcommand{\sij}[3]{\viiva\limits_{\hspace*{-5mm}{#1}}^{\hspace*{5mm}{#2}}{#3}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\B}[1]{\mathbf{#1}}
\newtheorem{thm}{Theorem} 
\newtheorem{thm1}{Theorem}
\newtheorem{thm2}{Theorem}
\newtheorem{thm3}{Theorem}
\theoremstyle{definition}
\newtheorem{lemma}[thm1]{Lemma}
\newtheorem{remark}[thm2]{Remark}
\newtheorem{defn}[thm3]{Definition}
\theoremstyle{plain}
\newtheorem{thm4}{Theorem}
\newtheorem{thm5}{Theorem}
\newtheorem{thm6}{Theorem}
\newtheorem{thm7}{Theorem} 
\newtheorem{prop}[thm4]{Proposition}
\newtheorem{kor}[thm5]{Corollary}
\newtheorem{conjecture}[thm6]{Conjecture}
\newtheorem{approximation}[thm7]{Approximation}
\usepackage{amsmath,amsfonts}
\usepackage{algorithmic}
\usepackage{array}
\usepackage[caption=false,font=normalsize]{subfig}
\usepackage{textcomp}
\usepackage{stfloats}
\usepackage{url}
\usepackage{verbatim}
\usepackage{graphicx}
\hyphenation{op-tical net-works semi-conduc-tor IEEE-Xplore}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\usepackage{balance}

\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}

\title{Stochastic geometry analysis of a narrow-beam LEO uplink with mixed Gaussian shadowing}

\author{\IEEEauthorblockN{1\textsuperscript{st} Ilari Angervuori}
\IEEEauthorblockA{\textit{Department of Electrical Engineering} \\
\textit{Aalto University}\\
Espoo, Finland \\
ilari.Angervuori@aalto.fi}
\and
\IEEEauthorblockN{3\textsuperscript{rd} Risto Wichman}
\IEEEauthorblockA{\textit{Department of Electrical Engineering} \\
\textit{Aalto University}\\
Espoo, Finland \\
risto.wichman@aalto.fi}
}
\maketitle
         \begin{abstract}
         \end{abstract}

         % Note that keywords are not normally used for peerreview papers.
         \begin{IEEEkeywords}
           LEO, SIR meta distribution, Nakagami fading
         \end{IEEEkeywords}


         \section{Introduction}

         
         \begin{table}
           \begin{center}
             \begin{tabular}{| c | p{7cm}  |}
               \hline
               \multicolumn{2}{|c|}{Glossary of principal symbols} \\
               \hline
               Symbol& Explanation 
               \\ 
               \hline
               $h$ & Altitude of the SBSs. \\
               $\epsilon$ & Elevation angle of the SBSs. \\
               $G[\cdot]$ & The SBS antenna gain.\\
               $\varphi_{\text{RX}}$ & Width of the SBSs $3$ dB gain. \\
               $\Theta \subset E $ & Poisson p.p. on the earth's surface $E \subset \R^3$. \\
               $\Phi \subset \R^2$ & Poisson p.p. on the plane. \\
               $x_0$ & Nearest point to the origin in $\Phi$.  \\
               $\lambda$ & Density parameter of $\Phi$ and $\Theta$. \\
               $\kappa$ & Parameter that reflects the approximate mean number of UEs inside a SBS's $3$ dB footprint;  $\kappa = h^2\pi \lambda \varphi_{\textup{RX}}^2/\sin^4(\epsilon)$. \\
               ${\tilde{\kappa}}$ &  $\kappa/\log(2)$.\\
               $g_x$ &   Gamma-distributed random fading gain of a transmitter $x$.     \\
               $\theta$ & SIR or SINR threshold for a successful transmission.\\
               $I$ & Interference at the typical SBS in the plane model.\\
               $S$ & The signal power of the served UE at the typical SBS in the plane model.\\
               $\mathring{I}$ & Interference at the typical SBS in the spherical model.\\
               $\mathring{S}$ & The signal power of the served UE at the typical SBS in the spherical model.\\ 
               $\hat{d}_{h,\epsilon}$ & The distance between the SBS and the center of the footprint in the plane model.\\
               $d_{0}$ & Normalizing distance.  \\                        
               \hline
             \end{tabular}
           \end{center}
         \end{table}   

         
         \section{Analysis}
         
         \subsection{Gain process}
         We denote the derivative of the function $\|x\| \mapsto \varphi_x $ at $\|x\| =0$ with $D_{h,\epsilon} \triangleq \sin^2(\epsilon)/h$. Consequently, $\varphi_x \approx D_{h,\epsilon}\|x\|$ for small $\|x\|$.
         Given a PPP $\Phi \subset \R^2$ of density $\lambda$, define the shadowed gain process (GP)
         \begin{equation}
           \label{eq:gainprocess}
           \mathcal{G} \triangleq \left\{x \in \Phi : H_x G(D_{h,\epsilon}\|x\|) \right\},
          \end{equation}
          where $\{H_x\}$ are i.i.d. shadowing variables, possibly degenerate, and 
          \begin{equation}
            G(\varphi) = 2^{-\varphi^2/\varphi^2_{\text{RX}}}
          \end{equation}
          is the Gaussian antenna pattern $G:[0,\infty) \rightarrow (0,1]$ characterized by the halfwidth of the $3$ dB gain $\varphi_{\text{RX}}$. We use the value $\varphi_{\text{RX}} = 1.6 \degree$ according to the International Telecommunication Union Recommendations (ITU-R) \cite{ITURS1528}. The GP is a \textit{projection process} and, as such, a nonhomogeneous PPP [CITE].

            The density of the GP has the following connection to the fading distribution:

            \begin{prop}[Density of the GP]
              Let $F_H(\cdot)$ be the complementary cdf (ccdf) of $H$. The density of $\mathcal{G}$ is given by
              \begin{equation}
                \label{eq:GPdensity}
                \lambda_{\mathcal{G}}(t)= \tilde{\kappa}F_H(t)/t, \text{ \text{for} }t>0,
              \end{equation}
              where $\tilde{\kappa}= \kappa/\log(2)$ and
              \begin{equation}
                \label{eq:kappa}
                      {\kappa} \triangleq    \pi \lambda   \left(\frac{h \varphi_{\textup{RX}}}{\sin^2(\epsilon)  }\right)^2
              \end{equation}
              is approximately the mean number of UEs inside the $3$ dB footprint of a SBS.            
              \begin{proof}
                Let $f_H(\cdot)$ be the pdf of $H$. We denote $G^{-1}(\cdot)$ as the generalized inverse $G^{-1}(y) = \inf \{x:G(x)<y\}$. By [CITE],
                \begin{align*}
                  &\int_t^{\infty}\lambda_{\mathcal{G}}(y)dy \overset{}{=} \pi \lambda \mathbb{E}\left[ \left(\frac{G^{-1}(t/H)}{D_{h,\epsilon}}\right)^2 \right] \\
                  &=\pi \lambda \int_t^{\infty} \left(-\frac{h \varphi_{\text{RX}}\sqrt{-\log(t/h)}}{\sin^2(\epsilon) \sqrt{\log(2)}}\right)^2f_H(h) dh  \\
                  &= -\tilde{\kappa} \int_t^{\infty} \log(t/h)f_H(h) dh\\
                  &\overset{(a)}{=} -\tilde{\kappa} \sij{t}{\infty} \log(t/h)F_H(h) - \tilde{\kappa} \int_t^{\infty}\frac{F_H(h)}{h} dh.
                \end{align*}
                In (a), we use the integration by parts. The result follows by derivating w.r.t. $t$ and taking the minus sign---as long as $\int_t^{\infty} \log(t/h)f_H(h) dh$ converges for all $t>0$.
              \end{proof}
            \end{prop}

          The mean and the variance of the total received power are given by
          \begin{align}
            &\mathbb{E}\left(\sum_{x \in \mathcal{G}} x \right) = \int_{0}^{\infty} t\lambda_{\mathcal{G}}(t) dt = \tilde{\kappa} \int_{0}^{\infty}F_H(t) dt \nonumber \\
            &=\tilde{\kappa} \mathbb{E}(H), \\\
            &\text{var}\left(\sum_{x \in \mathcal{G}} x \right) = \int_{0}^{\infty} t^2\lambda_{\mathcal{G}}(t) dt= \tilde{\kappa} \int_0^{\infty}tF_H(t) dt  \nonumber \\
           & \tilde{\kappa} \frac{\text{var}(H) + \mathbb{E}(H)^2}{2} = \tilde{\kappa}  \mathbb{E}[H^2]/2,
          \end{align}
          respectively. 

          Unfortunately, unlike in terrestrial networks with a singular path loss, where the density of the projection process is dependent only on a single moment of $H$, $\lambda_{\mathcal{G}}(t)$ has an explicit pointwise dependence on the ccdf of the fading distribution. However, the density functions are similar for certain fading distributions with matched moments. For example,

          \subsection{Multitier network}

          
          We consider $J$ different tiers identically and independently randomly assigned for each UE. In this work, the tiers represent different types of shadowing. We denote by $T_x \in \mathcal{T} \triangleq \{1,\dots, J\}$ the type (of the fading) of the UE $x \in \Phi $. Each tier is characterized by its unique fading variable and the probability $\mathbb{P}(T_x = i)$ that the transmitter belongs to tier $i$. It holds that $\sum_{i \in \mathcal{T}} \mathbb{P}(T_x = i) =1$. In this work, the probability is identical for all UEs, and we can denote $\mathbb{P}(T = i) \triangleq \mathbb{P}(T_x = i)$. Also, the fading variables are i.d.d.; hence, we denote $(H | T=i) \triangleq (H_x | T_x=i)$. We denote by $\Phi_i$ the point process of tier $i$ transmitters and $\mathcal{G}_i$ the corresponding GP. By the thinning theorem [CITE], both are PPPs, and if $\lambda$ is the density of $\Phi=\cup_{i \in \mathcal{T}} \Phi_i$, we can sum the densities of the separate tiers $\lambda = \sum_{i \in \mathcal{T}} \lambda_i$ with $\lambda_i \triangleq \lambda \mathbb{P}(T = i)$. Accordingly,  ${\kappa}_i \triangleq \mathbb{P}(T = i){\kappa}$, where $\kappa$ is the mean number of UEs inside the $3$ dB footprint in $\Phi$ as in $\eqref{eq:kappa}$, and $\kappa_i$ and $(H|T=i)$ determine the density $\lambda_{\mathcal{G}_i}(t)$ as in $\eqref{eq:GPdensity}$. Also the GP tiers can be superpositioned: if $\mathcal{G}$ is the GP of $\Phi=\cup_{i \in \mathcal{T}} \Phi_i$, $\lambda_{\mathcal{G}}(t)= \sum_{i \in \mathcal{T}}\lambda_{\mathcal{G}_i}(t)$. 

          Of course, the index set $\mathcal{T}$ does not have to be a set of the first $J$ integers; for example, we could you use $\mathcal{T}=\{\text{NLoS, LoS} \}$.

          \subsection{Signal-to-interference ratio}
          Let $W>0$ be a normalized noise power constant. As we consider a NB that decays much faster than the spatial path loss w.r.t. $\|x\|$, $x \in \Phi$ as in the definition of the GP \eqref{eq:gainprocess}, we approximate that \textbf{the spatial path loss is equal to all transmitters} and depends on the distance between the SBS and its antenna boresight location on the earth's surface $\hat{d}_{h,\epsilon}$. The path loss law is defined as $\ell({d_x}) \triangleq ({d_x}/d_0)^{\gamma}$, where $d_x$ is the Euclidean distance between the UE $x \in \mathcal{G}$ and the typical SBS, and $\gamma$ is the power path loss exponent. We define the SINR of the strongest signal $x_0 \triangleq \max  \mathcal{G}$ at the typical SBS as
          \begin{equation}
            \text{SINR} \triangleq \frac{x_0/\ell(\hat{d}_{h,\epsilon})}{\sum\limits_{x \in \mathcal{G} \setminus \{x_0\}}x/\ell(\hat{d}_{h,\epsilon})+ W}.
          \end{equation}

          \subsection{Laplace transform of the total received power}

          The Laplace function of the total of the points in $\mathcal{G}$ is defined as $S_{\mathcal{G}} \triangleq \sum_{x \in \mathcal{G}}x$, i.e., the \textit{total received power} scaled by the spatial path loss $\ell(\hat{d}_{h,\epsilon})$ from all UEs in $\mathcal{G}$ at the typical SBS, is given by

          \begin{equation}
            \label{eq:lapdef}
            \mathcal{L}_{S_{\mathcal{G}}}(s)\triangleq \mathbb{E}\left(e^{-s\sum\limits_{x \in \mathcal{G}}x}\right)= \exp\left\{-\int_0^{\infty}(1-e^{-sr}) \lambda_{\mathcal{G}}(r) dr \right\}.
          \end{equation}
          For independent $\{\mathcal{G}_i\}_{i \in \mathcal{\tau}}$, $\mathcal{L}_{\sum_{i \in \mathcal{T}} \mathcal{G}_i}(s) = \prod_{i \in \mathcal{T}} \mathcal{L}_{\mathcal{G}_i}(s)$

          
          \subsubsection{Rayleigh fading case}
          Assuming a exponential fading variable $H$ with mean $m$;
          \begin{equation}
            \label{eq:lapexp}
            \mathcal{L}_{S_{\mathcal{G}}}(s)= \exp\left\{-\mathcal{\kappa}\int_0^{\infty}(1-e^{-sr})\frac{e^{-r/m}}{r} dr \right\}=(1+sm)^{-\tilde{\kappa}},
          \end{equation}
          which is the Laplace transform of the \textbf{gamma distribution} with shape parameter $\tilde{\kappa}$ and scale parameter $m$: the total received power is gamma-distributed if all UEs are Rayleigh faded and approximately gamma-distributed with any fading that produces the GP that can be approximated with the exponential-type density function – like the log-normal fading in suitable regimes (see Figure [FIG]).
          
          
          We are ready to derive a approximation for the probability of coverage of the UE with the srongest signal.

            
          \begin{prop}
            Assume a network of density $\lambda$ with the tiers $\mathcal{T}$. Let $H_{x_0}$ be the shadowing variable, and ${x'}_0 =  H_{x_0}G(\|x_0\|) \in \mathcal{G} =\cup_{i \in \mathcal{T}} \mathcal{G}_i$ be the strongest signal of the UEs. In the simple coverage region $\theta \geq 1$,
            \begin{align}
              \label{eq:probofcov}
              &p_c(\theta) \triangleq \mathbb{P}\left( \frac{H_{x_0} G(\|x_0\|)}{\sum\limits_{x' \in   \mathcal{G} \setminus \{x'_0\}}x'  + W\ell(\hat{d}_{h,\epsilon})} > \theta \right) \nonumber \\      
              &\overset{(a)}= \sum_{i\in \mathcal{T}} \mathbb{P}(T_{x_0}  = i)\lambda \int_{ \R^2}\mathbb{P}\Bigg((H_{x_0}|T_{x_0} = i) > \theta  2^{\left(\frac{D_{h,\epsilon}\|y\|}{\varphi_{\textup{RX}}}\right)^2 } \nonumber \\
              &\cdot \left(\sum_{x \in \cup\mathcal{G}_i }x +W\ell(\hat{d}_{h,\epsilon}) \right)\Bigg) \nonumber dy  \nonumber  \\              
              &\overset{(b)}{\approx} 2 \pi \lambda\sum_{i\in \mathcal{T}} \mathbb{P}(T_{}  = i) \cdot \nonumber \\
              &\int_{0}^{\infty} r \prod_{k \in \mathcal{T}}\mathbb{E} \left(e^{-\frac{\theta \sum_{x \in { \mathcal{G}_k}} x}{2^{-(D_{h,\epsilon}r/\varphi_{\textup{RX}})^2} m_i  }} \cdot e^{- \theta   \frac{W\ell(\hat{d}_{h,\epsilon})}{2^{-(D_{h,\epsilon}r/\varphi_{\textup{RX}})^2} m_i}} \right) dr \nonumber \\
              &\overset{(c)}{=}   {} \sum_{i \in \mathcal{T}}\tilde{\kappa}_i\int_1^{\infty} \mathcal{L}_{S_{\mathcal{G}_i}}\left(\frac{\theta v  m_k}{m_i} \right)  \mathcal{L}_{W}\left( \frac{\theta vW\ell(\hat{d}_{h,\epsilon})}{m_i} \right)/v dv \nonumber \\
              &\overset{}{=}   {} \sum_{i \in \mathcal{T}} \tilde{\kappa}_i\int_1^{\infty}  \frac{\exp \{- \theta v W(\hat{d}_{h,\epsilon}/d_0)^{\gamma}/m_i \}}{v\prod\limits_{k \in \mathcal{T}}\left(1 + \theta v  m_k/m_i\right)^{\tilde{\kappa}_k}} dv,
            \end{align}
            where $m_j \triangleq \mathbb{E}(H| T = j)$ is the mean of the fading variable of tier $j$, $\tilde{\kappa}_i =\mathbb{P}(T_{}  = i) {\tilde{\kappa}}$, where $   \tilde{\kappa}\log(2)= \kappa=\pi \lambda   \left(h \varphi_{\textup{RX}}/\sin^2(\epsilon) \right)^2$ reflects the mean number of UEs inside the (spatial) $3$ dB footprint of all tiers as defined in the equation \eqref{eq:kappa}. The Laplace transform $\mathcal{L}_{S_\mathcal{G}}(s)$ is defined in \eqref{eq:lapdef} and is given for exponential $H$ in \eqref{eq:lapexp}. The Laplace transform of $W$ is defined accordingly as $\mathcal{L}_W(s) \triangleq \mathbb{E}\left(e^{-sW} \right)$, which reduces to $e^{-sW}$ for deterministic $W$.
            \begin{proof}
              The detailed proof is presented in [CITE]. Step (a) heuristically: In the simple coverage region, the UE is covered \textit{only if} it has the strongest signal. Using the translation invariance of the stationary PPP and utilizing Slivnyak's and Gambell's theorems leads to the probability of coverage given by the integral over the plane
.s
              In (b), we assume an exponential $(H_{x_0}|T_{x_0}=i)$ to approximate the probability of coverage, which allows the probability to be expressed in terms of the Laplace transforms of $S_{\mathcal{G}_i} = \sum_{x \in \cup \mathcal{G}_i}x$ and $W$. By the independent shadowing, they are independent and can be expressed as the product. In (c), we made the substitutions $D_{h,\epsilon}r/\varphi_{\text{RX}} \mapsto u$, and further, $2^{u^2} \mapsto v$.
              
            \end{proof}
          \end{prop}
          Notice that $p_c(\theta)$ is the probability of coverage of the UE with the \textit{strongest signal}, which is \textit{not} necessarily the spatially  \textit{nearest transmitter}.

          For a single-tier network in an interference-only channel $W=0$, the coverage probability depends on the mean number $\kappa = \tilde{\kappa} \log(2)$ of UEs inside the  $3$ dB footprint of the typical SBS and the threshold $\theta$, and \eqref{eq:probofcov} has the analytical expression
          \begin{equation}
p_c(\theta) =  \theta^{-\tilde{\kappa}} {_2F_1}\left(\tilde{\kappa}, \tilde{\kappa};\tilde{\kappa} + 1; -1/\theta \right).
          \end{equation}
          where $_2F_1(\cdot)$ is the hypergeometric function. 


          \subsection{Gaussian mixture model}
          Let us consider a two-tier $\mathcal{T} = \{\text{LoS},\text{NLoS}\}$ logarithmic Gaussian mixture fading model with the mean and standard deviation $\mu_{i},\sigma_{i}$, $i \in \{\text{LoS},\text{NLoS} \}$, for the line-of-sight and the non-line-of-sight tiers, respectively. Consequently, the power fading RV of a transmitter $x \in \Phi$ is given by
            \begin{align}
              &H_x  \nonumber \\
              &=   \mathds{1}(T_x =\text{LoS})e^{\mu_{\text{LoS}}+\sigma_{\text{LoS}}Z} +\mathds{1}(T_x =\text{NLoS})e^{\mu_{\text{NLoS}}+\sigma_{\text{NLoS}}Z},
            \end{align}
            where $\mathds{1}(\cdot)$ is the indicator function and $Z$ is a standard normal RV. Accordingly, the conditional fading variables follow a log-normal distribution
            \begin{align}
              \label{eq:tier1lognormal}
              &(H_x|T_x=\text{LoS}) \sim \text{Lognormal}(\mu_{\text{LoS}},\sigma_{\text{LoS}}^2) \\
              &(H_x|T_x=\text{NLoS}) \sim \text{Lognormal}(\mu_{\text{NLoS}},\sigma_{\text{NLoS}}^2).              \label{eq:tier2lognormal}
            \end{align}
            The mean of the lognormal RV is given by $ m_i=\mathbb{E}(H|T=i) = \exp \{\mu_i+\sigma_i^2/2\}$.
            
            In the two-tier network $\mathcal{T} =\{\text{LoS}, \text{NLoS}\}$ with the lognormal fading variables \eqref{eq:tier1lognormal} and \eqref{eq:tier2lognormal}, in the simple coverage region, the approximate probability of coverage is given by evaluating \eqref{eq:probofcov} with $m_{LoS}=\exp \{\mu_{\text{LoS}}+\sigma_{\text{LoS}}^2/2\}$, $m_{NLoS}=\exp \{\mu_{\text{NLoS}}+\sigma_{\text{NLoS}}^2/2\}$, $\mathcal{\kappa}_{\text{LoS}} = p_{\text{LoS}}\kappa$ and $\mathcal{\kappa}_{\text{NLoS}}=(1-p_{\text{LoS}})\kappa$, where $\kappa$ is given in given in $\eqref{eq:kappa}$, for a density $\lambda$ of the entire network.


         \bibliographystyle{IEEEtran}
         %\bibliography{IEEEabrv, bib}
         \bibliography{IEEEabrv,source}
             
             
\end{document}
